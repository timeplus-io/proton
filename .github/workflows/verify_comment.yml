name: VerifyComment

on:
  issue_comment:
    types:
      - created

jobs:
  verify:
    name: Verify PR comment
    permissions:
      actions: read # for downloading artifact
      id-token: write # This is required for requesting the JWT (needed for assume AWS IAM role)
      issues: write # for posting comments
    runs-on: ubuntu-latest
    steps:
      - name: Report Started
        run: |
          curl --show-error --silent -X POST \
            -H 'Content-Type: application/json' \
            -H 'Accept: application/vnd.github+json' \
            -H "Authorization: token ${{ secrets.GH_PERSONAL_ACCESS_TOKEN }}" \
            -d '{"body": "github workflow triggered: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}"}' \
            ${{ github.event.issue.comments_url }}

      - name: Print Info
        run: |
          echo "github.event.issue.pull_request: ${{ github.event.issue.pull_request }}"
          echo "github.event_name: ${{ github.event_name }}"
          echo "github.event.issue.state: ${{ github.event.issue.state }}"
          echo "github.event.issue.user.id: ${{ github.event.issue.user.id }}"
          echo "github.event.comment.body: ${{ github.event.comment.body }}"
          echo "github.event.issue.comments_url: ${{ github.event.issue.comments_url }}"
  work:
    needs: verify
    runs-on: ubuntu-latest
    steps:
      - name: Hello World
        run: |
          echo 'Hello World'
