{
    "test_suite_name": "changelogstream_join_table2",
    "tag": "smoke",
    "test_suite_config": {
        "setup": {
            "statements": [
            ]
        },
        "tests_2_run": {
            "ids_2_run": [
                "all"
            ],
            "tags_2_run": [],
            "tags_2_skip": {
                "default": [
                    "todo",
                    "to_support",
                    "change",
                    "bug",
                    "sample",
                    "native_not_support",
                    "not supported"
                ],
                "cluster": [
                    "view",
                    "cluster_table_bug"
                ]
            }
        }
    },
    "comments": "Tests covering the changelog stream join tables.",
    "tests": [
        {
            "id": 123,
            "tags": [
                "changelog",
                "table(changelog)",
                "left join",
                "not supported"
            ],
            "name": "changelog left join table(changelog)",
            "description": "changelog left join table(changelog)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) settings mode='changelog';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string) primary key jj settings mode='changelog';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk, _tp_delta) values(1, 2, 'a', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14123",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, b._tp_delta from test14_stream_2 as a left join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14123",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14123",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, _tp_delta) values(1, 2, 'a', -1);"
                        }
                    ]
                }
            ],
            "expected_results": []
        },
        {
            "id": 124,
            "tags": [
                "changelog",
                "table(versioned_kv)",
                "inner join",
                "not implemented"
            ],
            "name": "changelog inner join table(versioned_kv)",
            "description": "changelog inner join table(versioned_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) settings mode='changelog';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string) primary key jj settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(5, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14124",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, _tp_delta from test14_stream_2 as a inner join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14124",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14124",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k, _tp_delta) values(1, 2, 'a', -1);"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14124",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "5",
                            "2",
                            "c",
                            "1"
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "1",
                            "3",
                            "b",
                            "1"
                        ],
                        [
                            "5",
                            "2",
                            "a",
                            "5",
                            "2",
                            "c",
                            "1"
                        ],
                        [
                            "1",
                            "7",
                            "a",
                            "2",
                            "7",
                            "h",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "5",
                            "2",
                            "c",
                            "-1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 125,
            "tags": [
                "changelog",
                "table(versioned_kv)",
                "left join"
            ],
            "name": "changelog inner join table(versioned_kv)",
            "description": "changelog inner join table(versioned_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) settings mode='changelog';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string) primary key jj settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(5, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14125",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, _tp_delta from test14_stream_2 as a left join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14125",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 5, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 9, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14125",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k, _tp_delta) values(1, 2, 'a', -1);"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14125",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "5",
                            "2",
                            "c",
                            "1"
                        ],
                        [
                            "1",
                            "5",
                            "a",
                            "1",
                            "5",
                            "b",
                            "1"
                        ],
                        [
                            "5",
                            "2",
                            "a",
                            "5",
                            "2",
                            "c",
                            "1"
                        ],
                        [
                            "1",
                            "9",
                            "a",
                            "0",
                            "0",
                            "",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "5",
                            "2",
                            "c",
                            "-1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 126,
            "tags": [
                "changelog",
                "table(changelog_kv)",
                "inner join"
            ],
            "name": "changelog inner join table(changelog_kv)",
            "description": "changelog inner join table(changelog_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) settings mode='changelog';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string) primary key jj settings mode='changelog_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(5, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk, _tp_delta) values(1, 2, 'a', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14126",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, _tp_delta from test14_stream_2 as a inner join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14126",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14126",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k, _tp_delta) values(1, 2, 'a', -1);"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14126",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "1"
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "1",
                            "3",
                            "b",
                            "1"
                        ],
                        [
                            "5",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "1"
                        ],
                        [
                            "1",
                            "7",
                            "a",
                            "2",
                            "7",
                            "h",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "-1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 127,
            "tags": [
                "changelog",
                "table(changelog_kv)",
                "left join"
            ],
            "name": "changelog inner left table(changelog_kv)",
            "description": "changelog inner join table(changelog_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) settings mode='changelog';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string) primary key jj settings mode='changelog_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(5, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk, _tp_delta) values(1, 2, 'a', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14127",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, _tp_delta from test14_stream_2 as a left join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14127",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(5, 5, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14127",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k, _tp_delta) values(1, 2, 'a', -1);"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14127",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "1"
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "1",
                            "3",
                            "b",
                            "1"
                        ],
                        [
                            "5",
                            "5",
                            "a",
                            "0",
                            "0",
                            "",
                            "1"
                        ],
                        [
                            "1",
                            "7",
                            "a",
                            "2",
                            "7",
                            "h",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "-1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 128,
            "tags": [
                "changelog",
                "table(appendonly)",
                "inner join"
            ],
            "name": "changelog inner join table(appendonly)",
            "description": "changelog inner join table(appendonly)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) settings mode='changelog';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string)"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(5, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14128",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, _tp_delta from test14_stream_2 as a inner join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14128",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k, _tp_delta) values(1, 2, 'a', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14128",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 7, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14128",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "5",
                            "2",
                            "c",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "1"
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "1",
                            "3",
                            "b",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "5",
                            "2",
                            "c",
                            "-1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "-1"
                        ],
                        [
                            "1",
                            "7",
                            "a",
                            "2",
                            "7",
                            "h",
                            "1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 129,
            "tags": [
                "changelog",
                "table(changelog_kv)",
                "left join"
            ],
            "name": "changelog inner join table(changelog_kv)",
            "description": "changelog inner join table(changelog_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) settings mode='changelog';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(5, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14129",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, _tp_delta from test14_stream_2 as a left join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14129",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k, _tp_delta) values(1, 2, 'a', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14129",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 5, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14129",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "5",
                            "2",
                            "c",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "1"
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "1",
                            "3",
                            "b",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "5",
                            "2",
                            "c",
                            "-1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "-1"
                        ],
                        [
                            "1",
                            "5",
                            "a",
                            "0",
                            "0",
                            "",
                            "1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 130,
            "tags": [
                "version_kv",
                "table(changelog)",
                "inner join",
                "not supported"
            ],
            "name": "version_kv inner join table(changelog)",
            "description": "version_kv inner join table(changelog)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string) primary key jj settings mode='changelog';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk, _tp_delta) values(1, 2, 'a', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14130",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, _tp_delta from test14_stream_2 as a inner join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14130",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14130",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k, _tp_delta) values(1, 2, 'a', -1);"
                        }
                    ]
                }
            ],
            "expected_results": []
        },
        {
            "id": 131,
            "tags": [
                "version_kv",
                "table(changelog)",
                "left join",
                "not supported"
            ],
            "name": "version_kv left join table(changelog)",
            "description": "version_kv left join table(changelog)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string) primary key jj settings mode='changelog';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk, _tp_delta) values(1, 2, 'a', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14131",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, b._tp_delta from test14_stream_2 as a left join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14131",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, _tp_delta) values(1, 2, 'a', -1);"
                        }
                    ]
                }
            ],
            "expected_results": []
        },
        {
            "id": 132,
            "tags": [
                "version_kv",
                "table(versioned_kv)",
                "inner join"
            ],
            "name": "version_kv inner join table(versioned_kv)",
            "description": "version_kv inner join table(versioned_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string) primary key jj settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(4, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14132",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, _tp_delta from test14_stream_2 as a inner join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14132",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14132",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(4, 2, 'b');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14132",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "1"
                        ],
                        [
                            "1",
                            "7",
                            "a",
                            "2",
                            "7",
                            "h",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "-1"
                        ],
                        [
                            "4",
                            "2",
                            "b",
                            "4",
                            "2",
                            "a",
                            "1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 133,
            "tags": [
                "version_kv",
                "table(versioned_kv)",
                "left join"
            ],
            "name": "version_kv inner join table(versioned_kv)",
            "description": "version_kv inner join table(versioned_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string) primary key jj settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(4, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14133",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, _tp_delta from test14_stream_2 as a left join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14133",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14133",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(4, 2, 'b');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14133",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "1"
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "0",
                            "0",
                            "",
                            "1"
                        ],
                        [
                            "1",
                            "7",
                            "a",
                            "2",
                            "7",
                            "h",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "-1"
                        ],
                        [
                            "4",
                            "2",
                            "b",
                            "4",
                            "2",
                            "a",
                            "1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 134,
            "tags": [
                "version_kv",
                "table(changelog_kv)",
                "inner join"
            ],
            "name": "version_kv inner join table(changelog_kv)",
            "description": "version_kv inner join table(changelog_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string) primary key jj settings mode='changelog_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(4, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14134",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, _tp_delta from test14_stream_2 as a inner join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14134",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14134",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k, _tp_delta) values(1, 2, 'a', -1);"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14134",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "1"
                        ],
                        [
                            "1",
                            "7",
                            "a",
                            "2",
                            "7",
                            "h",
                            "1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 135,
            "tags": [
                "version_kv",
                "table(changelog_kv)",
                "left join"
            ],
            "name": "version_kv inner join table(changelog_kv)",
            "description": "version_kv inner join table(changelog_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string) primary key jj settings mode='changelog_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(4, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14135",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, _tp_delta from test14_stream_2 as a left join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14135",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14135",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k, _tp_delta) values(1, 2, 'a', -1);"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14135",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "1"
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "0",
                            "0",
                            "",
                            "1"
                        ],
                        [
                            "1",
                            "7",
                            "a",
                            "2",
                            "7",
                            "h",
                            "1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 136,
            "tags": [
                "versioned_kv",
                "table(appendonly)",
                "inner join"
            ],
            "name": "versioned_kv inner join table(appendonly)",
            "description": "versioned_kv inner join table(appendonly)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string)"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(4, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14136",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, _tp_delta from test14_stream_2 as a inner join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14136",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14136",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 7, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14136",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "-1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "-1"
                        ],
                        [
                            "5",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "1"
                        ],
                        [
                            "5",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "1"
                        ],
                        [
                            "1",
                            "7",
                            "a",
                            "2",
                            "7",
                            "h",
                            "1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 137,
            "tags": [
                "versioned_kv",
                "table(changelog_kv)",
                "left join"
            ],
            "name": "versioned_kv inner join table(changelog_kv)",
            "description": "versioned_kv inner join table(changelog_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string)"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(4, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14137",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, _tp_delta from test14_stream_2 as a left join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14137",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14137",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14137",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "1"
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "1",
                            "3",
                            "b",
                            "1"
                        ],
                        [
                            "1",
                            "7",
                            "a",
                            "2",
                            "7",
                            "h",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "-1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "-1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 138,
            "tags": [
                "changelog_kv",
                "table(changelog)",
                "inner join",
                "not supported"
            ],
            "name": "changelog_kv inner join table(changelog)",
            "description": "changelog_kv inner join table(changelog)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) primary key j settings mode='changelog_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string) primary key jj settings mode='changelog';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(4, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk, _tp_delta) values(1, 2, 'a', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14138",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, _tp_delta from test14_stream_2 as a inner join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14138",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14138",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k, _tp_delta) values(1, 2, 'a', -1);"
                        }
                    ]
                }
            ],
            "expected_results": []
        },
        {
            "id": 139,
            "tags": [
                "changelog_kv",
                "table(changelog)",
                "left join",
                "not supported"
            ],
            "name": "changelog_kv left join table(changelog)",
            "description": "changelog_kv left join table(changelog)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) primary key j settings mode='changelog_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string) primary key jj settings mode='changelog';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(4, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk, _tp_delta) values(1, 2, 'a', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14139",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, b._tp_delta from test14_stream_2 as a left join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14139",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14139",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k, _tp_delta) values(1, 2, 'a', -1);"
                        }
                    ]
                }
            ],
            "expected_results": []
        },
        {
            "id": 140,
            "tags": [
                "changelog_kv",
                "table(versioned_kv)",
                "inner join"
            ],
            "name": "changelog_kv inner join table(versioned_kv)",
            "description": "changelog_kv inner join table(versioned_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) primary key j settings mode='changelog_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string) primary key jj settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(4, 2, 'f');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14140",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, _tp_delta from test14_stream_2 as a inner join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14140",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14140",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k, _tp_delta) values(1, 2, 'a', -1);"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14140",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "f",
                            "1"
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "1",
                            "3",
                            "b",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "f",
                            "-1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 141,
            "tags": [
                "changelog_kv",
                "table(versioned_kv)",
                "left join"
            ],
            "name": "changelog_kv inner join table(versioned_kv)",
            "description": "changelog_kv inner join table(versioned_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) primary key j settings mode='changelog_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string) primary key jj settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(4, 2, 'f');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14141",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, _tp_delta from test14_stream_2 as a left join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14141",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14141",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k, _tp_delta) values(1, 2, 'a', -1);"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14141",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "f",
                            "1"
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "1",
                            "3",
                            "b",
                            "1"
                        ],
                        [
                            "1",
                            "7",
                            "a",
                            "0",
                            "0",
                            "",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "f",
                            "-1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 142,
            "tags": [
                "changelog_kv",
                "table(changelog_kv)",
                "inner join"
            ],
            "name": "changelog_kv inner join table(changelog_kv)",
            "description": "changelog_kv inner join table(changelog_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_2;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_2(i int, j int, k string) primary key j settings mode='changelog_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_2",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_2(ii int, jj int, kk string) primary key jj settings mode='changelog_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_2(ii, jj, kk, _tp_delta) values(1, 2, 'a', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14142",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, _tp_delta from test14_stream_2 as a inner join table(test14_table_2) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14142",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14142",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_2(i, j, k, _tp_delta) values(1, 2, 'a', -1);"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14142",
                    "expected_results": [
                        [
                            "1",
                            "3",
                            "a",
                            "1",
                            "3",
                            "b",
                            "1"
                        ]
                    ]
                }
            ]
        }
    ]
}