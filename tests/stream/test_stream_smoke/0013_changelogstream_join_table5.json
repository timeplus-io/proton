{
    "test_suite_name": "changelogstream_join_table5",
    "tag": "smoke",
    "test_suite_config": {
        "setup": {
            "statements": []
        },
        "tests_2_run": {
            "ids_2_run": [
                "all"
            ],
            "tags_2_run": [],
            "tags_2_skip": {
                "default": [
                    "todo",
                    "to_support",
                    "change",
                    "bug",
                    "sample",
                    "native_not_support",
                    "not supported"
                ],
                "cluster": [
                    "view",
                    "cluster_table_bug"
                ]
            }
        }
    },
    "comments": "Tests covering the changelog stream join tables.",
    "tests": [
        {
            "id": 183,
            "tags": [
                "append_only",
                "table(changelog_kv)",
                "multiple stream join",
                "left join"
            ],
            "name": "1st join result is append_only(stream join stream) left join table(changelog_kv)",
            "description": "1st join result is append_only(stream join stream) left join table(changelog_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table2_5(i2 int, j2 int, k2 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string) primary key j3 settings mode='changelog_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3, _tp_delta) values(5, 2, 'h', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14183",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "with t as (select * from test14_stream1_5 join test14_table2_5 on test14_stream1_5.j = test14_table2_5.j2)select i, j, k, i2, j2, k2, i3, j3, k3 from t left join table(test14_stream3_5) as k on t.j = k.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14183",
                            "wait": 1,
                            "query": "insert into test14_table2_5(i2, j2, k2) values(8, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table2_5(i2, j2, k2) values(6, 7, 'f');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14183",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_table2_5(i2, j2, k2) values(1, 5, 'b');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14183",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "0",
                            "0",
                            ""
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "0",
                            "0",
                            ""
                        ],
                        [
                            "1",
                            "7",
                            "a",
                            "6",
                            "7",
                            "f",
                            "1",
                            "7",
                            "a"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 184,
            "tags": [
                "append_only",
                "table(changelog_kv)",
                "multiple stream join",
                "inner join"
            ],
            "name": "1st join result is append_only(stream join stream) inner join table(changelog_kv)",
            "description": "1st join result is append_only(stream join stream) inner join table(changelog_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table2_5(i2 int, j2 int, k2 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string) primary key j3 settings mode='changelog_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3, _tp_delta) values(5, 2, 'h', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table2_5(i2, j2, k2) values(8, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table2_5(i2, j2, k2) values(6, 3, 'f');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table2_5(i2, j2, k2) values(1, 7, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14184",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "with t as (select * from test14_stream1_5 as a join table(test14_table2_5) as b on a.j = b.j2)select i, j, k, i2, j2, k2, i3, j3, k3 from t join table(test14_stream3_5) as k on t.j = k.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14184",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14184",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 7, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14184",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a"
                        ],
                        [
                            "1",
                            "7",
                            "a",
                            "1",
                            "7",
                            "b",
                            "1",
                            "7",
                            "a"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 185,
            "tags": [
                "append_only",
                "table(changelog_kv)",
                "multiple stream join",
                "left join"
            ],
            "name": "1st join result is append_only(stream join stream) left join table(changelog_kv)",
            "description": "1st join result is append_only(stream join stream) left join table(changelog_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table2_5(i2 int, j2 int, k2 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string) primary key j3 settings mode='changelog_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3, _tp_delta) values(5, 2, 'h', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table2_5(i2, j2, k2) values(8, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table2_5(i2, j2, k2) values(6, 3, 'f');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table2_5(i2, j2, k2) values(1, 7, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14185",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "with t as (select * from test14_stream1_5 as a join table(test14_table2_5) as b on a.j = b.j2)select i, j, k, i2, j2, k2, i3, j3, k3 from t left join table(test14_stream3_5) as k on t.j = k.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14185",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14185",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 7, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14185",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "0",
                            "0",
                            ""
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "6",
                            "3",
                            "f",
                            "0",
                            "0",
                            ""
                        ],
                        [
                            "1",
                            "7",
                            "a",
                            "1",
                            "7",
                            "b",
                            "1",
                            "7",
                            "a"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 186,
            "tags": [
                "append_only",
                "changelog_kv",
                "join",
                "materialized view",
                "not supported"
            ],
            "name": "1st join result is append_only join table(changelog_kv)(materiialized view(stream join table(stream)) join table(changelog_kv))",
            "description": "1st join result is append_only join table(changelog_kv)(materiialized view(stream join table(stream)) join table(changelog_kv))",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table2_5(i2 int, j2 int, k2 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string) primary key j3 settings mode='changelog_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "not",
                            "exist_wait": 1,
                            "query": "create  materialized view if not exists test14_view_5 as (select * from test14_stream1_5 as a join table(test14_table2_5) as b on a.j = b.j2);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(6, 3, '7');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3, _tp_delta) values(5, 2, 'h', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table2_5(i2, j2, k2) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table2_5(i2, j2, k2) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table2_5(i2, j2, k2) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table2_5(i2, j2, k2) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14186",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "select * from test14_view_5 join changelog(table(test14_stream3_5), j3) as c on test14_view_5.j = c.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14186",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 7, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": []
        },
        {
            "id": 187,
            "tags": [
                "changelog",
                "changelog",
                "inner join",
                "not supported"
            ],
            "name": "1st inner join result is changelog(stream join stream) inner join table(changelog)",
            "description": "1st inner join result is changelog(stream join stream) inner join table(changelog)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream2_5(i2 int, j2 int, k2 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string) settings mode='changelog';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(6, 3, '7');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 2, 'e');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3, _tp_delta) values(4, 2, 'c',-1);"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14187",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "with t as (select * from test14_stream1_5 as a join changelog(test14_stream2_5, j2) as b on a.j = b.j2)select i, j, k, i2, j2, k2, i3, j3, k3, _tp_delta from t join table(test14_stream3_5) as k on t.j = k.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14187",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 5, 'b');"
                        }
                    ]
                }
            ],
            "expected_results": []
        },
        {
            "id": 188,
            "tags": [
                "changelog",
                "changelog",
                "left join",
                "not supported"
            ],
            "name": "1st left join result is changelog(stream join stream) left join table(changelog)",
            "description": "1st left join result is changelog(stream join stream) left join table(changelog)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream2_5(i2 int, j2 int, k2 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string) settings mode='changelog';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(6, 3, '7');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 2, 'e');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3, _tp_delta) values(4, 2, 'c',-1);"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14188",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "with t as (select * from test14_stream1_5 as a join changelog(test14_stream2_5, j2) as b on a.j = b.j2)select i, j, k, i2, j2, k2, i3, j3, k3, _tp_delta from t left join table(test14_stream3_5) as k on t.j = k.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14188",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 5, 'b');"
                        }
                    ]
                }
            ],
            "expected_results": []
        },
        {
            "id": 189,
            "tags": [
                "changelog",
                "versioned_kv",
                "inner join"
            ],
            "name": "1st inner join result is changelog(stream join stream) inner join table(versioned_kv)",
            "description": "1st inner join result is changelog(stream join stream) inner join table(versioned_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream2_5(i2 int, j2 int, k2 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string) primary key j3 settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(6, 3, '7');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 2, 'e');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14189",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "with t as (select * from test14_stream1_5 as a join changelog(test14_stream2_5, j2) as b on a.j = b.j2)select i, j, k, i2, j2, k2, i3, j3, k3, _tp_delta from t inner join table(test14_stream3_5) as k on t.j = k.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14189",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14189",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 5, 'b');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14189",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "3",
                            "2",
                            "c",
                            "1"
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "1",
                            "3",
                            "b",
                            "6",
                            "3",
                            "7",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "3",
                            "2",
                            "c",
                            "-1"
                        ],
                        [
                            "5",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "3",
                            "2",
                            "c",
                            "1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 190,
            "tags": [
                "changelog",
                "versioned_kv",
                "left join"
            ],
            "name": "1st left join result is changelog(stream join stream) left join table(versioned_kv)",
            "description": "1st left join result is changelog(stream join stream) left join table(versioned_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream2_5(i2 int, j2 int, k2 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string) primary key j3 settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(6, 3, '7');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 2, 'e');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14190",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "with t as (select * from test14_stream1_5 as a join changelog(test14_stream2_5, j2) as b on a.j = b.j2)select i, j, k, i2, j2, k2, i3, j3, k3, _tp_delta from t left join table(test14_stream3_5) as k on t.j = k.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14190",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 5, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14190",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 5, 'b');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14190",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "3",
                            "2",
                            "c",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "3",
                            "2",
                            "c",
                            "-1"
                        ],
                        [
                            "5",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "3",
                            "2",
                            "c",
                            "1"
                        ],
                        [
                            "1",
                            "5",
                            "a",
                            "1",
                            "5",
                            "b",
                            "0",
                            "0",
                            "",
                            "1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 191,
            "tags": [
                "changelog",
                "versioned_kv",
                "join",
                "materialized view"
            ],
            "name": "1st join result is changelog join table(changelog)(materiialized view(stream join table(stream)) join table(versioned_kv))",
            "description": "1st join result is changelog join table(changelog)(materiialized view(stream join table(stream)) join table(versioned_kv))",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream2_5(i2 int, j2 int, k2 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string) primary key j3 settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(6, 3, '7');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 2, 'e');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 5, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_view_5",
                            "exist_wait": 5,
                            "query": "create  materialized view if not exists test14_view_5 as (select * from test14_stream1_5 as a join changelog(test14_stream2_5, j2) as b on a.j = b.j2);"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14191",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "select i, j, k, i2, j2, k2, i3, j3, k3 from test14_view_5 join table(test14_stream3_5) as c on test14_view_5.j = c.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14191",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 5, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14191",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(5, 2, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14191",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e"
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "1",
                            "3",
                            "b",
                            "6",
                            "3",
                            "7"
                        ],
                        [
                            "1",
                            "5",
                            "a",
                            "1",
                            "5",
                            "b",
                            "4",
                            "5",
                            "c"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e"
                        ],
                        [
                            "5",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 192,
            "tags": [
                "changelog",
                "table(append-only)",
                "inner join",
                "not supported"
            ],
            "name": "1st join result is changelog(stream join stream) inner join table(append-only)",
            "description": "1st join result is changelog(stream join stream) inner join table(append-only)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream2_5(i2 int, j2 int, k2 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(6, 3, '7');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 2, 'e');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(5, 3, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14192",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "with t as (select * from test14_stream1_5 as a join changelog(test14_stream2_5, j2) as b on a.j = b.j2)select * from t join table(test14_stream3_5) as k on t.j = k.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14192",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 5, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14192",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 5, 'b');"
                        }
                    ]
                }
            ],
            "expected_results": []
        },
        {
            "id": 193,
            "tags": [
                "changelog",
                "table(append-only)",
                "left join",
                "not supported"
            ],
            "name": "1st join result is changelog(stream join stream) left join table(append-only)",
            "description": "1st join result is changelog(stream join stream) left join table(append-only)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream2_5(i2 int, j2 int, k2 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(6, 3, '7');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 2, 'e');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(5, 3, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14193",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "with t as (select * from test14_stream1_5 as a join changelog(test14_stream2_5, j2) as b on a.j = b.j2)select i, j, k, i2, j2, k2, i3, j3, k3, _tp_delta from t left join table(test14_stream3_5) as k on t.j = k.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14193",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 5, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14193",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 5, 'b');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14193",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "c",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e",
                            "-1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "c",
                            "-1"
                        ],
                        [
                            "5",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e",
                            "1"
                        ],
                        [
                            "5",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "c",
                            "1"
                        ],
                        [
                            "1",
                            "5",
                            "a",
                            "1",
                            "5",
                            "b",
                            "0",
                            "0",
                            "",
                            "1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 194,
            "tags": [
                "changelog",
                "changelog(table(stream))",
                "inner join",
                "not supported"
            ],
            "name": "1st join result is changelog(stream join stream) inner join changelog(table(append-only))",
            "description": "1st join result is changelog(stream join stream) inner join changelog(table(append-only))",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream2_5(i2 int, j2 int, k2 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(6, 3, '7');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 2, 'e');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(8, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(6, 3, 'f');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14194",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "with t as (select * from test14_stream1_5 as a join changelog(test14_stream2_5, j2) as b on a.j = b.j2)select * from t join changelog(table(test14_stream3_5), j3) as k on t.j = k.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14194",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(5, 2, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": []
        },
        {
            "id": 195,
            "tags": [
                "changelog",
                "changelog(table(stream))",
                "left join",
                "not supported"
            ],
            "name": "1st join result is changelog(stream join stream) left join changelog(table(append-only))",
            "description": "1st join result is changelog(stream join stream) left join changelog(table(append-only))",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream2_5(i2 int, j2 int, k2 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(6, 3, '7');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 2, 'e');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(8, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(6, 3, 'f');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14195",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "with t as (select * from test14_stream1_5 as a join changelog(test14_stream2_5, j2) as b on a.j = b.j2)select * from t left join changelog(table(test14_stream3_5), j3) as k on t.j = k.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14195",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(5, 2, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": []
        },
        {
            "id": 196,
            "tags": [
                "changelog",
                "changelog",
                "inner join",
                "materialized view",
                "not supported"
            ],
            "name": "1st join result is changelog join table(changelog)(materiialized view(stream join table(stream)) inner join changelog(table(stream))",
            "description": "1st join result is changelog join table(changelog)(materiialized view(stream join table(stream)) inner join changelog(table(stream))",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table2_5(i2 int, j2 int, k2 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "not",
                            "exist_wait": 1,
                            "query": "create  materialized view if not exists test14_view_5 as (select * from test14_stream1_5 as a join table(test14_table2_5) as b on a.j = b.j2);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(6, 3, '7');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 2, 'e');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 7, 'd');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(5, 2, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table2_5(i2, j2, k2) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table2_5(i2, j2, k2) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table2_5(i2, j2, k2) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table2_5(i2, j2, k2) values(4, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table2_5(i2, j2, k2) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14196",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "select * from test14_view_5 join changelog(table(test14_stream3_5), j3) as c on test14_view_5.j = c.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14196",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 7, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": []
        },
        {
            "id": 197,
            "tags": [
                "changelog",
                "table(changelog_kv)",
                "multiple stream join"
            ],
            "name": "1st join result is changelog(stream join stream) inner join table(changelog_kv)",
            "description": "1st join result is changelog(stream join stream) inner join table(changelog_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream2_5(i2 int, j2 int, k2 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string) primary key j3 settings mode='changelog_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(6, 3, '7');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 2, 'e');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3, _tp_delta) values(6, 3, '7', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14197",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "with t as (select * from test14_stream1_5 as a join changelog(test14_stream2_5, j2) as b on a.j = b.j2)select i, j, k, i2, j2, k2, i3, j3, k3, _tp_delta from t join table(test14_stream3_5) as k on t.j = k.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14197",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(8, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(6, 3, 'f');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14197",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(4, 2, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14197",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "4",
                            "2",
                            "c",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "4",
                            "2",
                            "c",
                            "-1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e",
                            "-1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "4",
                            "2",
                            "c",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "4",
                            "2",
                            "c",
                            "-1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e",
                            "-1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "4",
                            "2",
                            "c",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e",
                            "1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 198,
            "tags": [
                "changelog",
                "table(changelog_kv)",
                "multiple stream join"
            ],
            "name": "1st join result is changelog(stream join stream) inner join table(changelog_kv)",
            "description": "1st join result is changelog(stream join stream) inner join table(changelog_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream2_5(i2 int, j2 int, k2 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string) primary key j3 settings mode='changelog_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(6, 3, '7');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 2, 'e');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3, _tp_delta) values(6, 3, '7', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14198",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "with t as (select * from test14_stream1_5 as a join changelog(test14_stream2_5, j2) as b on a.j = b.j2)select i, j, k, i2, j2, k2, i3, j3, k3, _tp_delta from t left join table(test14_stream3_5) as k on t.j = k.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14198",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(8, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(6, 3, 'f');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14198",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(4, 2, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14198",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "4",
                            "2",
                            "c",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e",
                            "1"
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "6",
                            "3",
                            "f",
                            "0",
                            "0",
                            "",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "4",
                            "2",
                            "c",
                            "-1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e",
                            "-1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "4",
                            "2",
                            "c",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "4",
                            "2",
                            "c",
                            "-1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e",
                            "-1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "4",
                            "2",
                            "c",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e",
                            "1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 199,
            "tags": [
                "changelog",
                "table(versioned_kv)",
                "multiple stream join"
            ],
            "name": "1st join result is changelog(stream join stream) inner join table(versioned_kv)",
            "description": "1st join result is changelog(stream join stream) inner join table(versioned_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream2_5(i2 int, j2 int, k2 string) primary key j2 settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string) primary key j3 settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(6, 3, '7');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 2, 'e');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 7, 'd');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(8, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(6, 3, 'f');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(4, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14199",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "with t as (select * from test14_stream1_5 as a join table(test14_stream2_5) as b on a.j = b.j2)select i, j, k, i2, j2, k2, i3, j3, k3, _tp_delta from t join table(test14_stream3_5) as k on t.j = k.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14199",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14199",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 5, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14199",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e",
                            1
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "6",
                            "3",
                            "f",
                            "6",
                            "3",
                            "7",
                            1
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e",
                            -1
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e",
                            1
                        ]
                    ]
                }
            ]
        },
        {
            "id": 200,
            "tags": [
                "changelog",
                "table(versioned_kv)",
                "multiple stream join"
            ],
            "name": "1st join result is changelog(stream join stream) left join table(versioned_kv)",
            "description": "1st join result is changelog(stream join stream) left join table(versioned_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream2_5(i2 int, j2 int, k2 string) primary key j2 settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string) primary key j3 settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(6, 3, '7');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 2, 'e');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 7, 'd');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(8, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(6, 3, 'f');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(4, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14200",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "with t as (select * from test14_stream1_5 as a join table(test14_stream2_5) as b on a.j = b.j2)select i, j, k, i2, j2, k2, i3, j3, k3, _tp_delta from t left join table(test14_stream3_5) as k on t.j = k.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14200",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14200",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 5, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14200",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e",
                            1
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "6",
                            "3",
                            "f",
                            "6",
                            "3",
                            "7",
                            1
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e",
                            -1
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "4",
                            "2",
                            "a",
                            "3",
                            "2",
                            "e",
                            1
                        ],
                        [
                            "1",
                            "5",
                            "a",
                            "1",
                            "5",
                            "b",
                            "0",
                            "0",
                            "",
                            1
                        ]
                    ]
                }
            ]
        },
        {
            "id": 201,
            "tags": [
                "changelog",
                "changelog",
                "join",
                "materialized view",
                "not supported"
            ],
            "name": "1st join result is changelog join table(changelog)(materiialized view(stream join table(stream)) join table(changelog))",
            "description": "1st join result is changelog join table(changelog)(materiialized view(stream join table(stream)) join table(changelog))",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream2_5(i2 int, j2 int, k2 string) primary key j2 settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(6, 3, '7');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(3, 2, 'e');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(5, 2, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_view_5",
                            "exist_wait": 5,
                            "query": "create  materialized view if not exists test14_view_5 as (select * from test14_stream1_5 as a join table(test14_stream2_5) as b on a.j = b.j2);"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14201",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "select * from test14_view_5 join changelog(table(test14_stream3_5), j3) as c on test14_view_5.j = c.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14201",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 7, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": []
        },
        {
            "id": 202,
            "tags": [
                "changelog",
                "table(appendonly)",
                "multiple stream join",
                "inner join"
            ],
            "name": "1st join result is changelog(stream join stream) inner join table(appendonly)",
            "description": "1st join result is changelog(stream join stream) inner join table(appendonly)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream2_5(i2 int, j2 int, k2 string) primary key j2 settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(5, 2, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14202",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "with t as (select * from test14_stream1_5 join test14_stream2_5 on test14_stream1_5.j = test14_stream2_5.j2)select i, j, k, i2, j2, k2, i3, j3, k3, _tp_delta from t join table(test14_stream3_5) as k on t.j = k.j3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14202",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(8, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(6, 3, 'f');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14202",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 5, 'b');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14202",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "5",
                            "2",
                            "h",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "4",
                            "2",
                            "c",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "5",
                            "2",
                            "h",
                            "-1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "4",
                            "2",
                            "c",
                            "-1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "5",
                            "2",
                            "h",
                            "1"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "8",
                            "2",
                            "a",
                            "4",
                            "2",
                            "c",
                            "1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 203,
            "tags": [
                "aggregation"
            ],
            "name": "aggregation on versioned_kv stream join table(versioned_kv)",
            "description": "aggregation on versioned_kv stream join table(versioned_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_5(ii int, jj int, kk string) primary key jj settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_5(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_5(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_5(ii, jj, kk) values(4, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14203",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "select count(1), a.i from test14_stream as a inner join table(test14_table_5) as b on a.i = b.ii group by a.i;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14203",
                            "wait": 1,
                            "query": "insert into test14_stream(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream(i, j, k) values(4, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream(i, j, k) values(2, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream(i, j, k) values(4, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream(i, j, k) values(2, 6, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14203",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream(i, j, k) values(1, 7, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14203",
                    "expected_results": [
                        [
                            "1",
                            "4"
                        ],
                        [
                            "2",
                            "4"
                        ],
                        [
                            "1",
                            "2"
                        ],
                        [
                            "1",
                            "4"
                        ],
                        [
                            "2",
                            "2"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 204,
            "tags": [
                "aggregation",
                "join",
                "table(changelog_kv)",
                "versioned_kv"
            ],
            "name": "aggregation on changelog stream join table(changelog_kv)",
            "description": "aggregation on changelog stream join table(changelog_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop view if exists test14_view_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream1_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream2_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream3_5;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream1_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream1_5(i int, j int, k string) primary key j settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream2_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream2_5(i2 int, j2 int, k2 string) primary key j2 settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream3_5",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream3_5(i3 int, j3 int, k3 string) primary key j3 settings mode='changelog_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 2, 'c');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(4, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3, _tp_delta) values(5, 2, 'h', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream3_5(i3, j3, k3) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14204",
                            "wait": 5,
                            "terminate": "manual",
                            "query": "with t as (select * from test14_stream1_5 join test14_stream2_5 on test14_stream1_5.i = test14_stream2_5.i2) select count(1), max(i), min(i), avg(i), k.i3 from t  join table(test14_stream3_5) as k on t.i = k.i3 group by k.i3;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14204",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 4, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(4, 5, 'f');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(4, 6, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream2_5(i2, j2, k2) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(1, 8, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14204",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream1_5(i, j, k) values(5, 8, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14204",
                    "expected_results": [
                        [
                            "1",
                            "1",
                            "1",
                            "1.0",
                            "1"
                        ],
                        [
                            "1",
                            "4",
                            "4",
                            "4.0",
                            "4"
                        ],
                        [
                            "1",
                            "1",
                            "1",
                            "1.0",
                            "1"
                        ],
                        [
                            "1",
                            "4",
                            "4",
                            "4.0",
                            "4"
                        ],
                        [
                            "4",
                            "1",
                            "1",
                            "1.0",
                            "1"
                        ],
                        [
                            "1",
                            "4",
                            "4",
                            "4.0",
                            "4"
                        ],
                        [
                            "2",
                            "1",
                            "1",
                            "1.0",
                            "1"
                        ]
                    ]
                }
            ]
        }
    ]
}