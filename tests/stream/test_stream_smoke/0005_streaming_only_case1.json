{
    "test_suite_name": "streaming_only1",
    "commments":
        "test_stream_only1 covering the steam query smoke cases for streaming only mode.",
    "test_suite_config": {
        "table_schemas":[
            {
                "name": "test_stream_only1",
                "type": "table",
                "query_parameters":"storage_type=streaming",
                "columns": [
                    {
                        "name": "id",
                        "type": "string"
                    },
                    {
                        "name": "location",
                        "type": "string"
                    },
                    {
                        "name": "value",
                        "type": "float32"
                    },
                    {
                        "name": "json",
                        "type": "string"

                    },
                    {
                        "name": "timestamp",
                        "type": "datetime64(3)",
                        "default": "now64(3)"
                    }
                ],
                "event_time_column":"timestamp"
            },
            {
                "name": "test_stream_only1_no_default_tp_time",
                "type": "table",
                "columns": [
                    {
                        "name": "id",
                        "type": "string"
                    },
                    {
                        "name": "location",
                        "type": "string"
                    },
                    {
                        "name": "value",
                        "type": "float32"
                    },
                    {
                        "name": "json",
                        "type": "string"

                    },
                    {
                        "name": "timestamp",
                        "type": "datetime64(3)",
                        "default": "now64(3)"
                    }
                ]
            },
            {
                "name": "test_stream_only1_seek",
                "type": "table",
                "columns": [
                    {
                        "name": "id",
                        "type": "string"
                    },
                    {
                        "name": "location",
                        "type": "string"
                    },
                    {
                        "name": "value",
                        "type": "float32"
                    },
                    {
                        "name": "json",
                        "type": "string"

                    },
                    {
                        "name": "timestamp",
                        "type": "datetime64(3)",
                        "default": "now64(3)"
                    }
                ],
                "event_time_column":"timestamp"
            },
            {
                "name": "test_stream_only1_d",
                "type": "table",
                "columns": [
                    {
                        "name": "id",
                        "type": "string"
                    },
                    {
                        "name": "type",
                        "type": "string"
                    }

                ]}

        ],
        "setup": {
            "inputs": [
                {"table_name":"test_stream_only1_d", "data": [
                ["dev1", "roof"],
                ["dev2", "field"],
                ["dev3", "window"],
                ["dev4", "wall"],
                ["dev5", "roof"],
                ["dev6", "window"],
                ["dev7", "wall"],
                ["dev8", "floor"]]
                }
            ]
        },
        "tests_2_run": {"ids_2_run": ["all"], "tags_2_run":[], "tags_2_skip":{"default":["todo", "to_support", "change", "bug", "sample","native_not_support", "func rename"],"cluster": ["view", "cluster_table_bug"]}}
    },

    "tests": [

        {
            "id": 28,
            "tags": ["join"],
            "name": "stream bumble aggregation join table",
            "description": "stream stream aggregation join",
            "steps":[
                {"statements": [
                    {"client":"python", "query_id":"601-1", "query_type": "stream","wait":2, "query_end_timer":6, "query":"select a.id, b.type, max(a.value), window_start, window_end from tumble(test_stream_only1, timestamp, interval 5 second) as a join table(test_stream_only1_d) as b on a.id = b.id group by a.id, b.type, window_start, window_end"}]},
                {"inputs": [
                    {"table_name":"test_stream_only1","depends_on":"601-1", "data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test_stream_only1", "data": [["dev4", "ca", 59, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:06"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:07"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:10"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:14"],
                    ["dev4", "ca", 76, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:11"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:15"]]}
                ]}
            ],

            "expected_results": [{"query_id":"601-1", "expected_results":
                    [["dev1", "roof", 57.3, "2020-02-02 20:01:00", "2020-02-02 20:01:05"],
                    ["dev2", "field", 66, "2020-02-02 20:01:00", "2020-02-02 20:01:05"],
                    ["dev2", "field", 58.3, "2020-02-02 20:01:05", "2020-02-02 20:01:10"],
                    ["dev4", "wall", 59, "2020-02-02 20:01:05", "2020-02-02 20:01:10"],
                    ["dev8", "floor", 67, "2020-02-02 20:01:05", "2020-02-02 20:01:10"],
                    ["dev4", "wall", 76, "2020-02-02 20:01:10", "2020-02-02 20:01:15"],
                    ["dev8", "floor", 77, "2020-02-02 20:01:10", "2020-02-02 20:01:15"],
                    ["dev3", "window", 80, "2020-02-02 20:01:10", "2020-02-02 20:01:15"]
                    ]}]
        },
        {
            "id": 29,
            "tags": ["join"],
            "name": "stream bumble aggregation join table w/where",
            "description": "stream stream aggregation join table w/where",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":1, "query":"select a.id, b.type, max(a.value), window_start, window_end from tumble(test_stream_only1, timestamp, interval 5 second) as a join table(test_stream_only1_d) as b on a.id = b.id where b.type = 'roof' or b.type = 'field' or b.type = 'wall' group by a.id, b.type, window_start, window_end"}]},
                {"inputs": [
                    {"table_name":"test_stream_only1", "depends_on":"601-1","data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"]]},
                    {"table_name":"test_stream_only1", "data": [["dev4", "ca", 59, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:06"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:07"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:10"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:14"],
                    ["dev4", "ca", 76, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:11"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"601-1", "expected_results":
                    [["dev1", "roof", 57.3, "2020-02-02 20:01:00", "2020-02-02 20:01:05"],
                    ["dev2", "field", 66, "2020-02-02 20:01:00", "2020-02-02 20:01:05"],
                    ["dev2", "field", 58.3, "2020-02-02 20:01:05", "2020-02-02 20:01:10"],
                    ["dev4", "wall", 59, "2020-02-02 20:01:05", "2020-02-02 20:01:10"],
                    ["dev4", "wall", 76, "2020-02-02 20:01:10", "2020-02-02 20:01:15"]
                    ]}]
        },
        {
            "id": 30,
            "tags": ["subquery"],
            "name": "tumble aggregation based on vanilla subquery extracts timestamp from json",
            "description": "tranform function in subquery and run tumble on the subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":1, "query":"with transformed as (select id, value, to_datetime(json_extract_string(json, 'create_time')) as tranformed_timestamp from test_stream_only1) select id, max(value), window_start, window_end from tumble(transformed, tranformed_timestamp, interval 5 second) group by id, window_start, window_end"}]},
                {"inputs": [
                    {"table_name":"test_stream_only1", "depends_on":"601-1","data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test_stream_only1", "data": [["dev1", "ca", 59, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2020-02-02 20:01:06"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2020-02-02 20:01:07"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2020-02-02 20:01:14"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"601-1", "expected_results":
                    [["dev1", 60, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                    ["dev2", 66, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                    ["dev4", 76, "2021-11-02 20:00:05", "2021-11-02 20:00:10"],
                    ["dev3", 80, "2021-11-02 20:00:05", "2021-11-02 20:00:10"],
                    ["dev8", 77, "2021-11-02 20:00:05", "2021-11-02 20:00:10"]
                    ]}]
        },

        {
            "id": 31,
            "tags": ["subquery"],
            "name": "hopping aggregation based on vanilla subquery extracts timestamp from json",
            "description": "tranform function in subquery to extract timestamp from a json and run hopping on the subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":1, "query":"with transformed as (select id, value, to_datetime(json_extract_string(json, 'create_time')) as tranformed_timestamp from test_stream_only1) select id, max(value), window_start, window_end from hop(transformed, tranformed_timestamp, interval 2 second, interval 5 second) group by id, window_start, window_end"}]},
                {"inputs": [
                    {"table_name":"test_stream_only1","depends_on":"601-1", "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test_stream_only1", "data": [["dev1", "ca", 59, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2020-02-02 20:01:06"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2020-02-02 20:01:07"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2020-02-02 20:01:14"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev1", 60, "2021-11-02 19:59:58", "2021-11-02 20:00:03"],
                ["dev2", 58.3, "2021-11-02 19:59:58", "2021-11-02 20:00:03"],
                ["dev2", 66, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev1", 60, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev1", 59, "2021-11-02 20:00:02", "2021-11-02 20:00:07"],
                ["dev2", 66, "2021-11-02 20:00:02", "2021-11-02 20:00:07"],
                ["dev8", 77, "2021-11-02 20:00:02", "2021-11-02 20:00:07"],
                ["dev1", 59, "2021-11-02 20:00:04", "2021-11-02 20:00:09"],
                ["dev8", 77, "2021-11-02 20:00:04", "2021-11-02 20:00:09"],
                ["dev3", 66, "2021-11-02 20:00:04", "2021-11-02 20:00:09"],
                ["dev4", 76, "2021-11-02 20:00:04", "2021-11-02 20:00:09"]
                ]}]
        },

        {
            "id": 32,
            "tags": ["subquery"],
            "name": "global aggregation based on vanilla subquery extracts timestamp from json",
            "description": "tranform function in subquery to extract timestamp from a json and run global aggregation on the subquery",
            "steps":[

                {
                "statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":8, "query":"with transformed as (select id, value, to_datetime(json_extract_string(json, 'create_time')) as tranformed_timestamp from test_stream_only1) select id, max(value) from transformed group by id limit 6 emit periodic 5s"}]},
                {"inputs": [
                    {"table_name":"test_stream_only1", "depends_on":"601-1","data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test_stream_only1", "data": [["dev1", "ca", 59, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2020-02-02 20:01:06"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2020-02-02 20:01:07"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2020-02-02 20:01:14"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev9", 77],
                ["dev2", 66],
                ["dev8", 77],
                ["dev1", 60],
                ["dev4", 76],
                ["dev3", 80]
                ]}]
        },

        {
            "id": 33,
            "tags": ["subquery"],
            "name": "tail based on tumble subquery extracts timestamp from json",
            "description": "tail based on tumble subquery extracts timestamp from json",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":1, "query":"with transformed_a as (select id, avg(value) as value_avg, window_end as avg_time from tumble(test_stream_only1, timestamp, interval 2 second) group by id, window_end) select id, value_avg, avg_time from transformed_a"}]},
                {"inputs": [
                    {"table_name":"test_stream_only1", "depends_on":"601-1","data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2020-02-02 20:01:03"],
                    ["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2020-02-02 20:01:04"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2020-02-02 20:01:07"],
                    ["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2020-02-02 20:01:10"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2020-02-02 20:01:15"]
                    ]}
                ]}
            ],

            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev1", 63, "2020-02-02 20:01:02"],
                ["dev2", 49, "2020-02-02 20:01:04"],
                ["dev8", 67, "2020-02-02 20:01:06"],
                ["dev8", 77, "2020-02-02 20:01:08"],
                ["dev4", 76, "2020-02-02 20:01:12"],
                ["dev3", 62, "2020-02-02 20:01:12"],
                ["dev3", 80, "2020-02-02 20:01:14"],
                ["dev4", 67, "2020-02-02 20:01:14"]

                ]}]
        },

        {
            "id": 34,
            "tags": ["subquery"],
            "name": "tumble based on tumble subquery",
            "description": "tranform function in subquery to extract timestamp from a json and run tumble aggregation on the subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":1, "query":"with transformed_a as (select id, avg(value) as value_avg, window_end as avg_time from tumble(test_stream_only1, timestamp, interval 2 second) group by id, window_end) select id, max(value_avg), window_end from tumble(transformed_a, avg_time, interval 5 second) group by id, window_end"}]},
                {"inputs": [
                    {"table_name":"test_stream_only1","depends_on":"601-1", "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test_stream_only1", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2020-02-02 20:01:04"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2020-02-02 20:01:07"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2020-02-02 20:01:10"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev1", 63, "2020-02-02 20:01:05"],
                ["dev2", 49, "2020-02-02 20:01:05"],
                ["dev8", 77, "2020-02-02 20:01:10"]
                ]}]
        },

        {
            "id": 35,
            "tags": ["subquery"],
            "name": "tumble minK based on tumble subquery",
            "description": "tumble minK based on tumble subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":1, "query":"with transformed_a as (select id, avg(value) as value_avg, window_end as avg_time from tumble(test_stream_only1, timestamp, interval 2 second) group by id, window_end) select id, min_k(value_avg, 1), window_end from tumble(transformed_a, avg_time, interval 5 second) group by id, window_end"}]},
                {"inputs": [
                    {"table_name":"test_stream_only1","depends_on":"601-1", "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test_stream_only1", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2020-02-02 20:01:04"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2020-02-02 20:01:07"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2020-02-02 20:01:10"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev1", "[63.0]", "2020-02-02 20:01:05"],
                ["dev2", "[49.0]", "2020-02-02 20:01:05"],
                ["dev8", "[67.0]", "2020-02-02 20:01:10"]
                ]}]
        },

        {
            "id": 36,
            "tags": ["subquery"],
            "name": "hopping avg based on tumble sum subquery",
            "description": "hopping avg based on tumble sum subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":2, "query":"with transformed_a as (select id, sum(value) as value_q, window_end as q_time from tumble(test_stream_only1, timestamp, interval 1 second) group by id, window_end) select id, avg(value_q), window_end from hop(transformed_a, q_time, interval 2 second, interval 5 second) group by id, window_end"}]},
                {"inputs": [
                    {"table_name":"test_stream_only1", "depends_on":"601-1","data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test_stream_only1", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]}
            ],
            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev1", 60, "2021-11-02 20:00:03"],
                ["dev2", 30, "2021-11-02 20:00:05"],
                ["dev1", 63, "2021-11-02 20:00:05"],
                ["dev1", 63, "2021-11-02 20:00:07"],
                ["dev2", 49, "2021-11-02 20:00:07"],
                ["dev8", 67, "2021-11-02 20:00:07"],
                ["dev2", 68, "2021-11-02 20:00:09"],
                ["dev4", 76, "2021-11-02 20:00:09"],
                ["dev8", 72, "2021-11-02 20:00:09"],
                ["dev1", 66, "2021-11-02 20:00:09"]
                ]}]
        },

        {
            "id": 37,
            "tags": ["subquery"],
            "name": "tumble avg based on hopping sum subquery",
            "description": "tumble avg based on hopping sum subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":1, "query":"with transformed_a as (select id, sum(value) as value_s, window_end as s_time from hop(test_stream_only1, timestamp, interval 1 second, interval 5 second) group by id, window_end) select id, avg(value_s), window_end from tumble(transformed_a, s_time, interval 3 second) group by id, window_end"}]},
                {"inputs": [
                    {"table_name":"test_stream_only1","depends_on":"601-1","data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test_stream_only1", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]}
            ],
            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev1", 60, "2021-11-02 20:00:03"],
                ["dev1", 104, "2021-11-02 20:00:06"],
                ["dev2", 52.67, "2021-11-02 20:00:06"],
                ["dev2", 88, "2021-11-02 20:00:09"],
                ["dev4", 76, "2021-11-02 20:00:09"],
                ["dev8", 118.33, "2021-11-02 20:00:09"],
                ["dev1", 86, "2021-11-02 20:00:09"]
                ]}]
        },

        {
            "id": 38,
            "tags": ["subquery","bug"],
            "name": "tumble avg based on hist subquery",
            "description": "tumble avg based on hist subquery",
            "steps":[
                {"inputs": [
                    {"table_name":"test_stream_only1","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test_stream_only1", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]},
                {"statements": [
                    {"client":"python","query_id":"601-1", "wait":1, "query_type": "table", "query_end_timer":1, "query":"with transformed as (select id, value, to_datetime(json_extract_string(json, 'create_time')) as tranformed_timestamp from table(test_stream_only1)) select id, max(value), window_end from tumble(transformed, tranformed_timestamp, interval 5 second) group by id, window_end"}]}
            ],

            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev1", 66, "2021-11-02 20:00:05"],
                ["dev4", 67, "2021-11-02 20:00:05"],
                ["dev2", 68, "2021-11-02 20:00:05"],
                ["dev3", 80, "2021-11-02 20:00:10"],
                ["dev4", 76, "2021-11-02 20:00:10"],
                ["dev8", 77, "2021-11-02 20:00:10"],
                ["dev9", 77, "2021-11-02 20:00:15"]
                ]}]
        },

        {
            "id": 39,
            "tags": ["subquery","bug"],
            "name": "hop count based on table subquery",
            "description": "hop count based on table subquery",
            "steps":[
                {"inputs": [
                    {"table_name":"test_stream_only1","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test_stream_only1", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev4", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]}
                ]},
                {"statements": [
                    {"client":"python", "wait": 2, "query_id":"601-1", "query_type": "stream", "query_end_timer":5, "query":"with transformed as (select id, value, to_datetime(json_extract_string(json, 'create_time')) as tranformed_timestamp from table(test_stream_only1)) select id, count(*), window_start, window_end from hop(transformed, tranformed_timestamp, interval 4 second, interval 5 second) group by id, window_start, window_end"}]}
            ],

            "expected_results": [{"query_id":"601-1", "expected_results":
                [
                ["dev2", 2, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev3", 2, "2021-11-02 20:00:04", "2021-11-02 20:00:09"],
                ["dev4", 2, "2021-11-02 20:00:04", "2021-11-02 20:00:09"],
                ["dev1", 2, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev2", 1, "2021-11-02 20:00:04", "2021-11-02 20:00:09"],
                ["dev3", 2, "2021-11-02 20:00:08", "2021-11-02 20:00:13"]
                ]}]
        },

        {
            "id": 40,
            "tags": ["subquery"],
            "name": "tumble count based on tumble join table subquery",
            "description": "tumble count based on tumble join table subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":5, "query":"with joined_stream as (select a.id, b.type, max(a.value), window_start as joined_w_start, window_end as joined_w_end from tumble(test_stream_only1, timestamp, interval 3 second) as a join table(test_stream_only1_d) as b on a.id = b.id where b.type = 'roof' or b.type = 'field' or b.type = 'wall' group by a.id, b.type, window_start, window_end) select id, count(*), window_start, window_end from tumble(joined_stream, joined_w_end, interval 5 second) group by id, window_start, window_end"}]},
                {"inputs": [
                    {"table_name":"test_stream_only1","depends_on":"601-1", "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test_stream_only1", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]}
            ],

            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev1", 1, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev2", 1,  "2021-11-02 20:00:00", "2021-11-02 20:00:05"]
                ]}]
        },


        {
            "id": 41,
            "tags": ["subquery"],
            "name": "hop count based on tumble join table subquery",
            "description": "hop count based on tumble join table subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":5, "query":"with joined_stream as (select a.id, b.type, max(a.value), window_start as joined_w_start, window_end as joined_w_end from tumble(test_stream_only1, timestamp, interval 3 second) as a join table(test_stream_only1_d) as b on a.id = b.id where b.type = 'roof' or b.type = 'field' or b.type = 'wall' group by a.id, b.type, window_start, window_end) select id, count(*), window_start, window_end from hop(joined_stream, joined_w_end, interval 3 second, interval 5 second) group by id, window_start, window_end"}]},
                { "inputs": [
                    {"table_name":"test_stream_only1", "depends_on":"601-1","data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test_stream_only1", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]}
            ],

            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev1", 1, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev2", 1,  "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev1", 2, "2021-11-02 20:00:03", "2021-11-02 20:00:08"],
                ["dev2", 2,  "2021-11-02 20:00:03", "2021-11-02 20:00:08"]
                ]}]
        },

        {
            "id": 42,
            "tags": ["subquery"],
            "name": "tumble count based on hop join table subquery",
            "description": "tumble count based on hop join table subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":5, "query":"with joined_stream as (select a.id, b.type, max(a.value), window_start as joined_w_start, window_end as joined_w_end from hop(test_stream_only1, timestamp, interval 3 second, interval 5 second) as a join table(test_stream_only1_d) as b on a.id = b.id where b.type = 'roof' or b.type = 'field' or b.type = 'wall' group by a.id, b.type, window_start, window_end) select id, count(*), window_start, window_end from tumble(joined_stream, joined_w_end, interval 3 second) group by id, window_start, window_end"}]},
                { "inputs": [
                    {"table_name":"test_stream_only1","depends_on":"601-1", "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test_stream_only1", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]}
            ],
            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev1", 1, "2021-11-02 20:00:00", "2021-11-02 20:00:03"],
                ["dev1", 1,  "2021-11-02 20:00:03", "2021-11-02 20:00:06"],
                ["dev2", 1, "2021-11-02 20:00:03", "2021-11-02 20:00:06"]
                ]}]
        },


        {
            "id": 43,
            "tags": ["subquery", "bug"],
            "name": "hop count based on hop join table subquery",
            "description": "hop count based on hopping sum subquery",
            "steps":[
                { "statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":5, "query":"with joined_stream as (select a.id, b.type, max(a.value), window_start as joined_w_start, window_end as joined_w_end from hop(test_stream_only1, timestamp, interval 3 second, interval 5 second) as a join table(test_stream_only1_d) as b on a.id = b.id where b.type = 'roof' or b.type = 'field' or b.type = 'wall' group by a.id, b.type, window_start, window_end) select id, count(*), window_start, window_end from hop(joined_stream, joined_w_end, interval 3 second, interval 5 second) group by id, window_start, window_end"}]},
                {"inputs": [
                    {"table_name":"test_stream_only1", "depends_on":"601-1","data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test_stream_only1", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev4", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]}
                ]}
            ],

            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev1", 1, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev2", 1,  "2021-11-02 20:00:03", "2021-11-02 20:00:08"],
                ["dev1", 1, "2021-11-02 20:00:03", "2021-11-02 20:00:08"]
                ]}]
        },


        {
            "id": 44,
            "tags": ["subquery", "bug"],
            "name": "global count based on tail join table subquery",
            "description": "global count based on tail join table subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "terminate":"manuel", "query_end_timer":1, "query":"with joined_stream as (select a.id, b.type, a.value, to_datetime(json_extract_string(json, 'create_time')) as tranformed_timestamp from test_stream_only1 as a join table(test_stream_only1_d) as b on a.id = b.id where b.type = 'roof' or b.type = 'field' or b.type = 'wall') select id, count(*) from joined_stream group by id"}]},
                {"inputs": [
                    {"table_name":"test_stream_only1","depends_on":"601-1", "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test_stream_only1","wait":1, "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test_stream_only1","wait":1, "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test_stream_only1", "wait":1,"data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]},
                {"statements": [
                    {"client":"python","query_id":"602-1", "query_type": "table", "query":"kill query where query_id='602-1'"}]}
            ],

            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev1", 2],
                ["dev2", 2],
                ["dev4", 2]
                ]}]
        },

        {
            "id": 45,
            "tags": ["subquery"],
            "name": "tumble count based on tail join table subquery",
            "description": "tumble count based on tail join table subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":1, "query":"with joined_stream as (select a.id, b.type, a.value, a.timestamp, to_datetime(json_extract_string(json, 'create_time')) as transformed_timestamp from test_stream_only1 as a join table(test_stream_only1_d) as b on a.id = b.id where b.type = 'roof' or b.type = 'field' or b.type = 'wall') select id, count(*), window_start, window_end from tumble(joined_stream,transformed_timestamp, 5s) group by id, window_start, window_end"}]},
                {"inputs": [
                    {"table_name":"test_stream_only1","depends_on":"601-1", "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test_stream_only1", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]}
            ],

            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev1", 2, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev2", 2,  "2021-11-02 20:00:00", "2021-11-02 20:00:05"]
                ]}]
        },

        {
            "id": 46,
            "tags": ["subquery"],
            "name": "hop count based on tail join table subquery",
            "description": "hop count based on tail join table subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":1, "query":"with joined_stream as (select a.id, b.type, a.value, a.timestamp, to_datetime(json_extract_string(json, 'create_time')) as transformed_timestamp from test_stream_only1 as a join table(test_stream_only1_d) as b on a.id = b.id where b.type = 'roof' or b.type = 'field' or b.type = 'wall') select id, count(*), window_start, window_end from hop(joined_stream,timestamp, 2s, 5s) group by id, window_start, window_end"}]},
                { "inputs": [
                    {"table_name":"test_stream_only1","depends_on":"601-1", "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test_stream_only1", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]}
            ],

            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev1", 1, "2021-11-02 19:59:58", "2021-11-02 20:00:03"],
                ["dev2", 1,  "2021-11-02 19:59:58", "2021-11-02 20:00:03"],
                ["dev1", 2, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev2", 2,  "2021-11-02 20:00:00", "2021-11-02 20:00:05"]
                ]}]
        },
        
        {
            "id": 47,
            "tags": ["view"],
            "name": "tumble sum based on tail join table view",
            "description": "tumble sum based on tail join table view",
            "steps":[
                {"statements": [
                    {"client":"python", "query_type": "table","wait":2,"query":"drop view if exists test_stream_only1_join_v"},
                    {"client":"python", "query_type": "table","wait":2,"query":"create view if not exists test_stream_only1_join_v as select a.id, b.type, a.value, a.json, a.timestamp, to_datetime(json_extract_string(json, 'create_time')) as transformed_timestamp, _tp_time from test_stream_only1 as a join table(test_stream_only1_d) as b on a.id =b.id"},
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":1, "drop_view":"test_stream_only1_join_v", "drop_view_wait":2, "query":"select id, type, sum(value), window_start, window_end from tumble(test_stream_only1_join_v, timestamp, 5s) group by id, type, window_start, window_end"}]},
                {"inputs": [
                    {"table_name":"test_stream_only1","depends_on":"601-1", "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test_stream_only1", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]}
            ],

            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev1", "roof", 126, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev2", "field", 98, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev8", "floor", 144, "2021-11-02 20:00:05", "2021-11-02 20:00:10"],
                ["dev3", "window", 204, "2021-11-02 20:00:05", "2021-11-02 20:00:10"],
                ["dev4", "wall", 143, "2021-11-02 20:00:05", "2021-11-02 20:00:10"]
                ]}]
        },


        {
            "id": 48,
            "tags": ["view"],
            "name": "global sum based on tail join table view",
            "description": "global sum based on tail join table view",
            "steps":[
                {"statements": [
                    {"client":"python", "query_type": "table","wait":2,"query":"drop view if exists test_stream_only1_join_v"},
                    {"client":"python", "query_type": "table","wait":2,"query":"create view if not exists test_stream_only1_join_v as select a.id, b.type, a.value, a.json, a.timestamp, to_datetime(json_extract_string(json, 'create_time')) as transformed_timestamp, _tp_time from test_stream_only1 as a join table(test_stream_only1_d) as b on a.id =b.id"},                    
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":7,"drop_view":"test_stream_only1_join_v", "drop_view_wait":2, "query":"select type, count(value) from test_stream_only1_join_v group by type limit 5 emit periodic 5s"}]},
                {"inputs": [
                    {"table_name":"test_stream_only1","depends_on":"601-1", "data": [
                      ["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                      ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                      ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"],
                      ["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                      ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                      ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test_stream_only1", "data": [
                      ["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                      ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                      ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                      ["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                      ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                      ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]}                               
            ],
            "expected_results": [{"query_id":"601-1", "expected_results":
                [["roof", 2],
                ["field", 2],
                ["floor", 3],
                ["window", 3],
                ["wall", 2]
                ]}]
        },        

        {
            "id": 49,
            "tags": ["settings", "query_mode","bug"],
            "name": "query_mode='table'",
            "description": "query_mode='table'",
            "steps":[
                {"inputs": [
                    {"table_name":"test_stream_only1","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test_stream_only1", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]},
                {"statements": [
                    {"client":"python","wait": 4,"query_id":"601-1", "query_type": "table", "query_end_timer":1, "query":"select id, avg(value) from test_stream_only1 group by id settings query_mode='table'"}]}
            ],

            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev2", 49],
                ["dev8", 73.67],
                ["dev1", 63],
                ["dev4", 71.5],
                ["dev3", 68]
                ]}]
        },


        {
            "id": 50,
            "tags": ["settings", "asterisk_include_reserved_columns","bug"],
            "name": "asterisk_include_reserved_columns = false",
            "description": "asterisk_include_reserved_columns = false",
            "steps":[
                {"inputs": [
                    {"table_name":"test_stream_only1","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test_stream_only1", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]},
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "table", "wait":1, "query":"select *  from test_stream_only1 where id = 'dev1' settings query_mode='table', asterisk_include_reserved_columns=false"}]}
            ],

            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"]
                ]}]
        },

        {
            "id": 51,
            "tags": ["seek to"],
            "name": "seek to earliest",
            "description": "seek to earliest, no command could clear stream storage so not stable, so use test_stream_only1_seek table created during setup to avoid stream storage impact, will introduce topic clean function in test_stream_only1 automation later",
            "steps":[
                {"inputs": [
                    {"table_name":"test_stream_only1","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test_stream_only1", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]},
                {"statements": [
                    {"client":"python","wait": 4,"query_id":"601-1", "query_type": "stream", "query_end_timer":1, "query":"select id, count(*), window_start, window_end from tumble(test_stream_only1, timestamp, 5s) where id = 'dev1' group by id, window_start, window_end settings seek_to = 'earliest'"}]}
            ],

            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev1", 2, "2021-11-02 20:00:00", "2021-11-02 20:00:05"],
                ["dev1", 1, "2021-11-02 20:00:05", "2021-11-02 20:00:10"]
                ]}]
        },

        {
            "id": 52,
            "tags": ["seek to", "to reproduce", "native_not_support"],
            "name": "seek to ago interval",
            "description": "seek to ago interval",
            "steps":[
                {"inputs": [
                    {"table_name":"test_stream_only1","wait":1, "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                    ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                    ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                    {"table_name":"test_stream_only1", "sleep": "60", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]}
                ]},
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":5, "query":"select id, value from test_stream_only1 settings seek_to='-5s'"}]}
            ],

            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev2", 68],
                ["dev8", 67],
                ["dev8", 77]
                ]}]
        },

        {
            "id": 53,
            "tags": ["seek to", "bug"],
            "name": "seek to specific time",
            "description": "seek to specific time",
            "steps":[
                {"inputs": [
                    {"table_name":"test_stream_only1", "wait":1,"data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2021-11-02 20:00:01"],
                        ["dev1", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2021-11-02 20:00:03"],
                        ["dev2", "ca", 30, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2021-11-02 20:00:02"]]},
                        {"table_name":"test_stream_only1", "data": [["dev2", "ca", 68, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2021-11-02 20:00:04"],
                        ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2021-11-02 20:00:05"],
                        ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2021-11-02 20:00:06"]]},
                        {"table_name":"test_stream_only1", "data": [["dev3", "ca", 58, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                        ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2021-11-02 20:00:08"],
                        ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"]]},
                        {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2021-11-02 20:00:09"],
                        ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2021-11-02 20:00:07"],
                        ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2021-11-02 20:00:10"]]}
                ]},
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":5, "query":"select id, count(*), window_end from tumble(test_stream_only1, 5s) group by id, window_end settings seek_to='2021-11-02T20:00:05'"}]}
            ],

            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev3", 3, "2021-11-02 20:00:10"],
                ["dev8", 4, "2021-11-02 20:00:10"],
                ["dev4", 2, "2021-11-02 20:00:10"]
                ]}]
        },

        {
            "id": 60,
            "tags": ["materialized view", "global aggregation"],
            "name": "streaming tail from materialized view as global aggregation by sum and group by id w/by 5s periodic",
            "description": "create materialized view as global aggregation by sum and group by id w/by 5s periodic, select id, sum_value from mv",
            "steps":[
                {"statements": [
                    {"client":"python", "query_type": "table", "query":"drop view if exists test_stream_only1_stream_sum_view"},
                    {"client":"python", "query_type": "table", "wait": 1, "query":"create materialized view test_stream_only1_stream_sum_view as select id, sum(value) as sum_value from test_stream_only1 group by id emit periodic 5s"},
                    {"client":"python", "query_id":"601-1", "query_type": "stream","depends_on_stream":"test_stream_only1_stream_sum_view","wait":5, "terminate":"manual","drop_view":"test_stream_only1_stream_sum_view", "drop_view_wait":2, "query":"select id, sum_value from test_stream_only1_stream_sum_view"}]},
                {"inputs": [
                    {"table_name":"test_stream_only1","depends_on":"601-1", "data": [["dev1", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev1", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"],
                    ["dev2", "ca", 59, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"],
                    ["dev3", "ca", 57.3, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:00"],
                    ["dev3", "ca", 66, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 76, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:05"],["dev2", "ca", 80, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:03"],
                    ["dev8", "ca", 67, "\"create_time\":\"2021-11-02 20:00:01\"", "2020-02-02 20:01:02"],
                    ["dev8", "ca", 77, "\"create_time\":\"2021-11-02 20:00:10\"", "2020-02-02 20:01:08"]
                    ]}
                ]},
                {"statements": [
                    {"client":"python", "wait": 6, "depends_on":"601-1", "query_type": "table", "query":"kill query where query_id = '601-1'"}
                ]
                }
            ],

            "expected_results": [{"query_id":"601-1", "expected_results":[
                ["dev2", "273.3"],
                ["dev8", "288"],
                ["dev1", "123.3"],
                ["dev3", "123.3"]]}
            ]
        },

        {
            "id": 81,
            "tags": ["functions", "streaming functions"],
            "name": "neighbor",
            "description": "function neighbor for streaming",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"602-1", "query_type": "stream","query_end_timer":1, "query":"select value, neighbor(value, -3) as prev_3, neighbor(value, -3, 0) as prev_3_0 from test_stream_only1"}]},
                {"inputs": [
                    {"table_name":"test_stream_only1", "depends_on":"602-1","wait":1, "data": [
                        ["dev1", "ca", 1, "2021-11-02 20:00:01", "2020-02-02 20:00:01"]
                        ]},
                    {"table_name":"test_stream_only1", "data": [
                        ["dev2", "ca", 2, "2021-11-02 20:00:10", "2020-02-02 20:01:02"],
                        ["dev2", "ca", 3, "2021-11-02 20:00:10", "2020-02-02 20:00:02"],
                        ["dev2", "ca", 4, "2021-11-02 20:00:10", "2020-02-02 20:01:02"]
                        ]},
                    {"table_name":"test_stream_only1", "data": [
                        ["dev3", "ca", 5, "2021-11-02 20:00:10", "2020-02-02 20:01:03"]
                        ]}
                ]}
            ],
            "expected_results": [
                {"query_id":"602-1", "expected_results": [
                    [1, 0, 0],
                    [2, 0, 0],
                    [3, 0, 0],
                    [4, 1, 1],
                    [5, 2, 2]
                ]}]
        },
        {
            "id": 90,
            "tags": ["tumble window", "functions", "func rename"],
            "name": "tumble w/funcs: json, to_date, replace_regex, to_time",
            "description": "extract timestamp from json and run tumble on it, and run all func rename.",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), json_extract_bool(json, 'bool') as json_bool, to_date(json_extract_string(json, '1953')) as to_date, replace_regex(json_extract_string(json, '1953'), '11*', 'a') as replace_regex, json_extract_float(json, 'float') as json_float, json_extract_int(json, 'int') as json_extract_int, json_query(json, '$.array[*][0 to 2, 4]') as json_query, json_extract_array_raw(json, 'array') as json_extract_array_raw, json_value(json, '$.array[*][0 to 2, 4]') as json_value, window_end from tumble(test_stream_only1, to_time(json_extract_string(json, 'create_time')), interval 5 second) where window_end < '2021-11-02 20:00:10' group by id, json, json_bool, json_float, json_extract_int, to_date, replace_regex, json_extract_array_raw, json_value, window_end"}

                ]},

                {"inputs": [
                    {"table_name":"test_stream_only1", "depends_on":"601-1","data": [["dev1", "ca", 60, "{\"create_time\":\"11/02/2021 20:00:01\", \"1953\":\"1953-11-02\", \"float\":127.001, \"int\":600, \"bool\":true, \"array\":[[20, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\", \"1953\":\"1953-11-02\", \"float\":127.001,\"int\":600.03, \"bool\":true, \"array\":[[1, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"11-02-2021 20:00:02\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int\": 312,\"bool\":false, \"array\":[[22, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test_stream_only1", "data": [["dev1", "ca", 59, "{\"create_time\":\"11.02.2021 20:00:04\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int\": 65536.001, \"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:06"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":true, \"array\":[[3, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"11-02-2021 20:00:06\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":false, \"array\":[[4, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":true, \"array\":[[5, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:14"],
                    ["dev2", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":false, \"array\":[[90, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:13"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"bool\":true, \"array\":[[72, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:12"],
                    ["dev3", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"bool\":true, \"array\":[[7, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"601-1", "expected_results":
                    [["dev2", 66, "1", "1953-11-02", "a953-a-02", "127.001", "0", "[1, 1, 4, 0, -1, -4]", "['[1,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']","1", "2021-11-02 20:00:05"],
                    ["dev1", 59, "1", "1953-11-02", "a953-a-02", "0", "0", "[0, 1, 4, 0, -1, -4]", "['[0,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']","0", "2021-11-02 20:00:05"],
                    ["dev1", 60, "1", "1953-11-02", "a953-a-02", "127.001", "600", "[20, 1, 4, 0, -1, -4]", "['[20,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']","20", "2021-11-02 20:00:05"],
                    ["dev2", 58.3, "0", "1953-11-02", "a953-a-02", "127.001", "312", "[22, 1, 4, 0, -1, -4]", "['[22,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']","22", "2021-11-02 20:00:05"]
                    ]}]
        },

        {
            "id": 91,
            "tags": ["tumble window", "functions", "func rename", "bug"],
            "name": "tumble w/funcs: json, to_date, replace_regex, to_time",
            "description": "extract timestamp from json and run tumble on it, and run all func rename.",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), json_extract_bool(json, 'bool') as json_bool, to_date(json_extract_string(json, '1953')) as to_date, replace_regex(json_extract_string(json, '1953'), '11*', 'a') as replace_regex, json_extract_float(json, 'float') as json_float, json_extract_int(json, 'int') as json_extract_int, json_query(json, '$.array[*][0 to 2, 4]') as json_query, json_extract_array_raw(json, 'array') as json_extract_array_raw, json_value(json, '$.array[*][0 to 2, 4]') as json_value, window_end from tumble(test_stream_only1, to_time(json_extract_string(json, 'create_time')), interval 5 second) where window_end < '2021-11-02 20:00:10' group by id, json, json_bool, json_float, json_extract_int, to_date, replace_regex, json_extract_array_raw, json_value, window_end"}

                ]},
                {"inputs": [
                    {"table_name":"test_stream_only1", "depends_on":"601-1", "data": [["dev1", "ca", 60, "{\"create_time\":\"11/02/2021 20:00:01\", \"1953\":\"1953-11-02\", \"float\":127.001, \"int\": 231584178474632390847141970017375815706539969331281128078915168015826259279872, \"bool\":true, \"array\":[[20, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\", \"1953\":\"1953-11-02\", \"float\":127.001,\"int\":600.03, \"bool\":true, \"array\":[[1, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"11-02-2021 20:00:02\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int\": 65536,\"bool\":false, \"array\":[[22, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test_stream_only1", "data": [["dev1", "ca", 59, "{\"create_time\":\"11.02.2021 20:00:04\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int\": 65536.001, \"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:06"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":true, \"array\":[[3, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"11-02-2021 20:00:06\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":false, \"array\":[[4, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":true, \"array\":[[5, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:14"],
                    ["dev2", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":false, \"array\":[[90, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:13"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"bool\":true, \"array\":[[72, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:12"],
                    ["dev3", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"bool\":true, \"array\":[[7, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev2", 66, "1", "2133-04-08", "a953-a-02", "127.001", "0", "[1, 1, 4, 0, -1, -4]", "['[1,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']","1", "2021-11-02 20:00:05"],
                ["dev1", 59, "1", "2133-04-08", "a953-a-02", "0", "0", "[0, 1, 4, 0, -1, -4]", "['[0,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']","0", "2021-11-02 20:00:05"],
                ["dev1", 60, "1", "2133-04-08", "a953-a-02", "127.001", "0", "[20, 1, 4, 0, -1, -4]", "['[20,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']","20", "2021-11-02 20:00:05"],
                ["dev2", 58.3, "0", "2133-04-08", "a953-a-02", "127.001", "65536", "[22, 1, 4, 0, -1, -4]", "['[22,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']","22", "2021-11-02 20:00:05"]
                ]}]
        },

        {
            "id": 92,
            "tags": ["tumble window", "functions", "func rename"],
            "name": "tumble w/funcs: to_int, happy path",
            "description": "extract timestamp from json and run tumble on it, and run all func rename.",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), to_int8(json_extract_string(json, 'int8')) as to_int8, to_int16(json_extract_string(json, 'int16')) as to_int16, to_int(json_extract_string(json, 'int32')) as to_int32, to_int64(json_extract_string(json, 'int64')) as to_int64, to_int128(json_extract_string(json, 'int128')) as to_int128, to_int256(json_extract_string(json, 'int256')) as to_int256, window_end from tumble(test_stream_only1, to_time(json_extract_string(json, 'create_time')), interval 5 second) where window_end < '2021-11-02 20:00:10' group by id, json, to_int8, to_int16, to_int32, to_int64, to_int128, to_int256, window_end"}

                ]},

                {"inputs": [
                    {"table_name":"test_stream_only1", "depends_on":"601-1", "data": [["dev1", "ca", 60, "{\"create_time\":\"11/02/2021 20:00:01\", \"1953\":\"1953-11-02\", \"float\":127.001, \"int8\": -127, \"int16\": -888, \"int32\": -8888, \"int64\": -8888, \"int128\": -88888, \"int256\": -888888, \"bool\":true, \"array\":[[20, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\", \"1953\":\"1953-11-02\", \"float\":127.001, \"int8\": \"127\", \"int16\": 888, \"int32\": 8888, \"int64\": 8888, \"int128\": 88888,\"int256\": 888888, \"bool\":true, \"array\":[[1, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"11-02-2021 20:00:02\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": 888, \"int32\": 8888, \"int64\": 8888, \"int128\": 88888,\"int256\": 888888,\"bool\":false, \"array\":[[22, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test_stream_only1", "data": [["dev1", "ca", 59, "{\"create_time\":\"11.02.2021 20:00:04\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\":6000 , \"int32\":6000 , \"int64\": 6888, \"int128\": 6999, \"int256\": 7999,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:06"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[3, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"11-02-2021 20:00:06\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":false, \"array\":[[4, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[5, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:14"],
                    ["dev2", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":false, \"array\":[[90, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:13"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[72, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:12"],
                    ["dev3", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[7, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"601-1", "expected_results":
                    [["dev2", 66, "127","888", "8888", "8888", "88888", "888888", "2021-11-02 20:00:05"],
                    ["dev1", 59, "126","6000", "6000", "6888", "6999", "7999", "2021-11-02 20:00:05"],
                    ["dev1", 60, "-127","-888", "-8888", "-8888", "-88888", "-888888", "2021-11-02 20:00:05"],
                    ["dev2", 58.3, "126", "888", "8888", "8888", "88888", "888888","2021-11-02 20:00:05"]
                    ]}]
        },


        {
            "id": 93,
            "tags": ["tumble window", "functions", "func rename", "bug"],
            "name": "tumble w/funcs: to_int, boundry",
            "description": "extract timestamp from json and run tumble on it, and run all func rename.",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), to_int8(json_extract_string(json, 'int8')) as to_int8, to_int16(json_extract_string(json, 'int16')) as to_int16, to_int32(json_extract_string(json, 'int32')) as to_int32, to_int64(json_extract_string(json, 'int64')) as to_int64, to_int128(json_extract_string(json, 'int128')) as to_int128, to_int256(json_extract_string(json, 'int256')) as to_int256, window_end from tumble(test_stream_only1, to_time(json_extract_string(json, 'create_time')), interval 5 second) where window_end < '2021-11-02 20:00:10' group by id, json, to_int8, to_int16, to_int32, to_int64, to_int128, to_int256, window_end"}

                ]},

                {"inputs": [
                    {"table_name":"test_stream_only1", "depends_on":"601-1", "data": [["dev1", "ca", 60, "{\"create_time\":\"11/02/2021 20:00:01\", \"1953\":\"1953-11-02\", \"float\":127.001, \"int8\": -127, \"int16\": -32767, \"int32\": -2147483647, \"int64\": -9223372036854775807, \"int128\": -170141183460469231731687303715884105727, \"int256\": -7896044618658097711785492504343953926634992332820282019728792003956564819967, \"bool\":true, \"array\":[[20, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\", \"1953\":\"1953-11-02\", \"float\":127.001, \"int8\": \"127\", \"int16\": 32767, \"int32\": 2147483647, \"int64\": 9223372036854775807, \"int128\": 170141183460469231731687303715884105727,\"int256\": 7896044618658097711785492504343953926634992332820282019728792003956564819967, \"bool\":true, \"array\":[[1, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"11-02-2021 20:00:02\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"120\",\"int16\": 5535, \"int32\": 294968295, \"int64\": 223372036854775807, \"int128\": 70141183460469231731687303715884105727,\"int256\": 896044618658097711785492504343953926634992332820282019728792003956564819967,\"bool\":false, \"array\":[[22, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test_stream_only1", "data": [["dev1", "ca", 59, "{\"create_time\":\"11.02.2021 20:00:04\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\":6000 , \"int32\":6000 , \"int64\": 6888, \"int128\": 6999, \"int256\": 7999,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:06"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[3, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"11-02-2021 20:00:06\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":false, \"array\":[[4, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[5, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:14"],
                    ["dev2", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":false, \"array\":[[90, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:13"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[72, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:12"],
                    ["dev3", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[7, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"601-1", "expected_results":
                [["dev2", 66, "127","32767", "2147483647", "9223372036854775807", "170141183460469231731687303715884105727", "7896044618658097711785492504343953926634992332820282019728792003956564819967", "2021-11-02 20:00:05"],
                ["dev1", 59, "126","6000", "6000", "6888", "6999", "7999", "2021-11-02 20:00:05"],
                ["dev1", 60, "-127","-32767", "--2147483647", "-9223372036854775807", "-170141183460469231731687303715884105727", "-7896044618658097711785492504343953926634992332820282019728792003956564819967", "2021-11-02 20:00:05"],
                ["dev2", 58.3, "120", "5535", "294968295", "223372036854775807", "70141183460469231731687303715884105727", "896044618658097711785492504343953926634992332820282019728792003956564819967","2021-11-02 20:00:05"]
                ]}]
        },


        {
            "id": 94,
            "tags": ["tumble window", "functions", "func rename", "todo"],
            "name": "tumble w/funcs: to_int, out of boundry",
            "description": "extract timestamp from json and run tumble on it, and run all func rename.",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), to_int8(json_extract_string(json, 'int8')) as to_int8, to_int16(json_extract_string(json, 'int16')) as to_int16, to_int32(json_extract_string(json, 'int32')) as to_int32, to_int64(json_extract_string(json, 'int64')) as to_int64, to_int128(json_extract_string(json, 'int128')) as to_int128, to_int256(json_extract_string(json, 'int256')) as to_int256, window_end from tumble(test_stream_only1, to_time(json_extract_string(json, 'create_time')), interval 5 second) where window_end < '2021-11-02 20:00:10' group by id, json, to_int8, to_int16, to_int32, to_int64, to_int128, to_int256, window_end"}

                ]},

                {"inputs": [
                    {"table_name":"test_stream_only1", "depends_on":"601-1", "data": [["dev1", "ca", 60, "{\"create_time\":\"11/02/2021 20:00:01\", \"1953\":\"1953-11-02\", \"float\":127.001, \"int8\": -127, \"int16\": -65535, \"int32\": -4294967295, \"int64\": -18446744073709551615, \"int128\": -340282366920938463463374607431768211455, \"int256\": -115792089237316195423570985008687907853269984665640564039457584007913129639935, \"bool\":true, \"array\":[[20, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\", \"1953\":\"1953-11-02\", \"float\":127.001, \"int8\": \"127\", \"int16\": 65535, \"int32\": 4294967295, \"int64\": 18446744073709551615, \"int128\": 340282366920938463463374607431768211455,\"int256\": 115792089237316195423570985008687907853269984665640564039457584007913129639935, \"bool\":true, \"array\":[[1, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"11-02-2021 20:00:02\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"312\",\"int16\": 75535, \"int32\": 4294968295, \"int64\": 18446744073719551615, \"int128\": 340282366920938463463374607431778211455,\"int256\": 115792089237316195423570985008687907853269984665640564039457584008913129639935,\"bool\":false, \"array\":[[22, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test_stream_only1", "data": [["dev1", "ca", 59, "{\"create_time\":\"11.02.2021 20:00:04\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\":6000 , \"int32\":4194968295 , \"int64\": 16446744073719551615, \"int128\": 330282366920938463463374607431768211455, \"int256\":605792089237316195423570985008687907853269984665640564039457584007913129639935,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:06"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[3, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"11-02-2021 20:00:06\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":false, \"array\":[[4, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[5, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:14"],
                    ["dev2", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":false, \"array\":[[90, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:13"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[72, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:12"],
                    ["dev3", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int8\": \"126\",\"int16\": -127, \"int32\": -127, \"int64\": -127, \"int128\": -127,\"int256\": -127,\"bool\":true, \"array\":[[7, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"601-1", "expected_results":
                    [["dev2", 66, "127", "2021-11-02 20:00:05"],
                    ["dev1", 59, "126", "2021-11-02 20:00:05"],
                    ["dev1", 60, "-127", "2021-11-02 20:00:05"],
                    ["dev2", 58.3, "56", "2021-11-02 20:00:05"]
                    ]}]
        },

        {
            "id":600,
            "tags": ["tumble window", "functions", "func rename"],
            "name": "tumble w/funcs: to_decimal, happy path",
            "description": "extract timestamp from json and run tumble on it, and run all func rename.",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), to_decimal(json_extract_string(json, 'decimal32'), 5) as to_decimal32, to_decimal64(json_extract_string(json, 'decimal64'), 10) as to_decimal64, to_decimal128(json_extract_string(json, 'decimal128'), 20) as to_decimal128, to_decimal256(json_extract_string(json, 'decimal256'),30) as to_decimal256, window_end from tumble(test_stream_only1, to_time(json_extract_string(json, 'create_time')), interval 5 second) where window_end < '2021-11-02 20:00:10' group by id, json, to_decimal32, to_decimal64, to_decimal128, to_decimal256, window_end"}

                ]},

                {"inputs": [
                    {"table_name":"test_stream_only1", "depends_on":"601-1", "data": [["dev1", "ca", 60, "{\"create_time\":\"11/02/2021 20:00:01\", \"1953\":\"1953-11-02\", \"float\":127.001, \"decimal32\": \"-9.99999999999999999999999999999999999999999999999\", \"decimal64\": -0.99999999999999999999999999999999999999999999999, \"decimal128\": -9.99999999999999999999999999999999999999999999999, \"decimal256\": -9.99999999999999999999999999999999999999999999999, \"bool\":true, \"array\":[[20, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\", \"1953\":\"1953-11-02\", \"float\":127.001, \"decimal32\": 0.99999999999999999999999999999999999999999999999, \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": 0.99999999999999999999999999999999999999999999999, \"bool\":true, \"array\":[[1, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"11-02-2021 20:00:02\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": 0.99999999999999999999999999999999999999999999999,\"bool\":false, \"array\":[[22, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test_stream_only1", "data": [["dev1", "ca", 59, "{\"create_time\":\"11.02.2021 20:00:04\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:06"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": 0.99999999999999999999999999999999999999999999999,\"bool\":true, \"array\":[[3, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"11-02-2021 20:00:06\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": 0.99999999999999999999999999999999999999999999999,\"bool\":false, \"array\":[[4, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": 0.99999999999999999999999999999999999999999999999,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": 0.99999999999999999999999999999999999999999999999,\"bool\":true, \"array\":[[5, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:14"],
                    ["dev2", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": 0.99999999999999999999999999999999999999999999999,\"bool\":false, \"array\":[[90, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": 0.99999999999999999999999999999999999999999999999,\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:13"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": 0.99999999999999999999999999999999999999999999999,\"bool\":true, \"array\":[[72, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:12"],
                    ["dev3", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": 0.99999999999999999999999999999999999999999999999, \"decimal256\": 0.99999999999999999999999999999999999999999999999,\"bool\":true, \"array\":[[7, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"601-1", "expected_results":
                    [["dev2", 66, "1", "0.9999999999", "1", "1", "2021-11-02 20:00:05"],
                    ["dev1", 59, "0.99999","1","1","0.999999999999999999999999999999", "2021-11-02 20:00:05"],
                    ["dev1", 60, "-9.99999", "-1","-10","-10", "2021-11-02 20:00:05"],
                    ["dev2", 58.3, "0.99999", "1", "0.99999999999999999999","1", "2021-11-02 20:00:05"]
                    ]}]
        },

        {
            "id":601,
            "tags": ["tumble window", "functions", "func rename", "todo"],
            "name": "tumble w/funcs: to_decimal, boundry",
            "description": "extract timestamp from json and run tumble on it, and run all func rename.",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), to_decimal32(json_extract_string(json, 'decimal32'), 8) as to_decimal32, to_decimal64(json_extract_string(json, 'decimal64'), 17) as to_decimal64, to_decimal128(json_extract_string(json, 'decimal128'), 37) as to_decimal128, to_decimal256(json_extract_string(json, 'decimal256'),75) as to_decimal256, window_end from tumble(test_stream_only1, to_time(json_extract_string(json, 'create_time')), interval 5 second) where window_end < '2021-11-02 20:00:10' group by id, json, to_decimal32, to_decimal64, to_decimal128, to_decimal256, window_end"}

                ]},

                {"inputs": [
                    {"table_name":"test_stream_only1", "depends_on":"601-1", "data": [["dev1", "ca", 60, "{\"create_time\":\"11/02/2021 20:00:01\", \"1953\":\"1953-11-02\", \"float\":127.001, \"decimal32\": \"-9.99999999999999999999999999999999999999999999999\", \"decimal64\": \"-9.99999999999999999999999999999999999999999999999\", \"decimal128\": \"-9.99999999999999999999999999999999999999999999999\", \"decimal256\": \"-9.99999999999999999999999999999999999999999999999\", \"bool\":true, \"array\":[[20, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\", \"1953\":\"1953-11-02\", \"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\", \"bool\":true, \"array\":[[1, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"11-02-2021 20:00:02\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": 0.99999999999999999999999999999999999999999999999, \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":false, \"array\":[[22, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test_stream_only1", "data": [["dev1", "ca", 59, "{\"create_time\":\"11.02.2021 20:00:04\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.9999999999999999999999999999999999999999999999\"9, \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:06"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":true, \"array\":[[3, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"11-02-2021 20:00:06\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":false, \"array\":[[4, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":true, \"array\":[[5, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:14"],
                    ["dev2", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\", \"1953\":\"1953-11-02\",\"float\":127.001, \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":false, \"array\":[[90, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":true, \"array\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:13"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":true, \"array\":[[72, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:12"],
                    ["dev3", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"decimal32\": \"0.99999999999999999999999999999999999999999999999\", \"decimal64\": \"0.99999999999999999999999999999999999999999999999\", \"decimal128\": \"0.99999999999999999999999999999999999999999999999\", \"decimal256\": \"0.99999999999999999999999999999999999999999999999\",\"bool\":true, \"array\":[[7, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"601-1", "expected_results":
                    [["dev2", 66, "127", "2021-11-02 20:00:05"],
                    ["dev1", 59, "126", "2021-11-02 20:00:05"],
                    ["dev1", 60, "-127", "2021-11-02 20:00:05"],
                    ["dev2", 58.3, "56", "2021-11-02 20:00:05"]
                    ]}]
        },
        {
            "id":602,
            "tags": ["tumble window", "functions", "func rename"],
            "name": "tumble w/funcs: array, happy path)",
            "description": "extract timestamp from json and run tumble on it, and run all func rename.",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), json_extract_array_raw(json, 'array1') as array1, json_extract_array_raw(json, 'array1') as array2 , array_concat(array1, array2) as array_concat, length(array_concat) as array_length, window_end from tumble(test_stream_only1, to_time(json_extract_string(json, 'create_time')), interval 5 second) where window_end < '2021-11-02 20:00:10' group by id, json, array1, array2, array_concat, array_length, window_end"}

                ]},

                {"inputs": [
                    {"table_name":"test_stream_only1", "depends_on":"601-1", "data": [["dev1", "ca", 60, "{\"create_time\":\"11/02/2021 20:00:01\", \"1953\":\"1953-11-02\", \"float\":127.001, \"int\":600, \"bool\":true, \"array1\":[[20, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[20, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\", \"1953\":\"1953-11-02\", \"float\":127.001,\"int\":600.03, \"bool\":true, \"array1\":[[1, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"11-02-2021 20:00:02\", \"1953\":\"1953-11-02\",\"float\":127.001, \"int\": 312,\"bool\":false, \"array1\":[[22, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test_stream_only1", "data": [["dev1", "ca", 59, "{\"create_time\":\"11.02.2021 20:00:04\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"int\": 65536.001, \"bool\":true, \"array1\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:06"],
                    ["dev1", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":true, \"array1\":[[3, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[3, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:07"],
                    ["dev1", "ca", 77, "{\"create_time\":\"11-02-2021 20:00:06\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":false, \"array1\":[[4, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[4, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":true, \"array1\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":true, \"array1\":[[5, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[5, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:14"],
                    ["dev2", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\", \"1953\":\"1953-11-02\",\"float\":127.001, \"bool\":false, \"array1\":[[90, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[90, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"bool\":true, \"array1\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[0, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:13"],
                    ["dev3", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"bool\":true, \"array1\":[[72, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[72, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:12"],
                    ["dev3", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\", \"1953\":\"1953-11-02\",\"float\":\"127.001\", \"bool\":true, \"array1\":[[7, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]], \"array2\":[[7, 1, 2, 3, 4, 5],[0, -1, -2, -3, -4, -5]]}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"601-1", "expected_results":
                    [
                    ["dev1", 59, "['[0,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "['[0,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "['[0,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]', '[0,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "4", "2021-11-02 20:00:05"],
                    ["dev2", 66, "['[1,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "['[1,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "['[1,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]', '[1,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "4", "2021-11-02 20:00:05"],
                    ["dev1", 60, "['[20,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "['[20,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "['[20,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]', '[20,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "4", "2021-11-02 20:00:05"],
                    ["dev2", 58.3, "['[22,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "['[22,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "['[22,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]', '[22,1,2,3,4,5]', '[0,-1,-2,-3,-4,-5]']", "4", "2021-11-02 20:00:05"]
                    ]}]
        },
        {
            "id": 888,
            "tags": ["hopping window", "timestamp extracted from json", "bug"],
            "name": "hop w/transformed timestamp",
            "description": "tranform function in subquery and run tumble on the subquery",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"601-1", "query_type": "stream", "query_end_timer":5, "query":"select id, max(value), window_end from hop(test_stream_only1, to_datetime64(_tp_append_time, 3, 'UTC'), interval 2 second, interval 5 second) where window_end < '2021-11-02 20:00:09' group by id, window_end"}]},
                {"inputs": [
                    {"table_name":"test_stream_only1","depends_on":"601-1", "data": [["dev1", "ca", 60, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:00"],
                    ["dev2", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:03\"}", "2020-02-02 20:01:01"],
                    ["dev2", "ca", 58.3, "{\"create_time\":\"2021-11-02 20:00:02\"}", "2020-02-02 20:01:03"]]},
                    {"table_name":"test_stream_only1", "data": [["dev1", "ca", 59, "{\"create_time\":\"2021-11-02 20:00:04\"}", "2020-02-02 20:01:06"],
                    ["dev8", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:05\"}", "2020-02-02 20:01:07"],
                    ["dev8", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:06\"}", "2020-02-02 20:01:10"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 57.3, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:11"],
                    ["dev3", "ca", 66, "{\"create_time\":\"2021-11-02 20:00:08\"}", "2020-02-02 20:01:14"],
                    ["dev4", "ca", 76, "{\"create_time\":\"2021-11-02 20:00:07\"}", "2020-02-02 20:01:11"]]},
                    {"table_name":"test_stream_only1", "data": [["dev3", "ca", 80, "{\"create_time\":\"2021-11-02 20:00:09\"}", "2020-02-02 20:01:13"],
                    ["dev4", "ca", 67, "{\"create_time\":\"2021-11-02 20:00:01\"}", "2020-02-02 20:01:12"],
                    ["dev9", "ca", 77, "{\"create_time\":\"2021-11-02 20:00:10\"}", "2020-02-02 20:01:15"]]}
                ]}
            ],
            "expected_results": [{"query_id":"601-1", "expected_results":
                    [["dev2", 58.3, "2021-11-02 20:00:03"],
                    ["dev1", 60, "2021-11-02 20:00:03"],
                    ["dev1", 60, "2021-11-02 20:00:05"],
                    ["dev2", 66, "2021-11-02 20:00:05"],
                    ["dev1", 59, "2021-11-02 20:00:07"],
                    ["dev8", 77, "2021-11-02 20:00:07"],
                    ["dev2", 66, "2021-11-02 20:00:07"]
                    ]}]
        },

        {
            "id": 889,
            "tags": ["input", "sample"],
            "name": "inputs sample",
            "description": "ingest data into test_stream_only1 w/full columes and values",
            "steps":[
                {"statements": [
                    {"client":"python","query_type": "input", "query":"truncate stream test_stream_only1"},
                    {"client":"python","query_id":"601-1", "query_type": "input", "query":"insert into test_stream_only1 (id, location, value, json, timestamp) values ('dev1', 'ca', 370, 'jsonstring', '1999-01-01 11:11:11')"},
                    {"client":"python","query_id":"602-1", "query_type": "input", "query":"insert into test_stream_only1 (id, location, value, json, timestamp) values ('dev2', 'ca', 380, 'jsonstring', '1999-01-01 11:11:11')"}

                    ]},
                {"statements": [
                    {"client":"python","query_id":"603-1", "wait": 1, "query_type": "table", "query_end_timer":5, "query":"select id, location, value,json, timestamp from table(test_stream_only1)"}]}

                ],
            "expected_results": [{"query_id":"603-1", "expected_results":
                    [["dev1", "ca", 370, "jsonstring", "1999-01-01 11:11:11"],
                    ["dev2", "ca", 380, "jsonstring", "1999-01-01 11:11:11"]
                    ]}]
        }



    ]
}
