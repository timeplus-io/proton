{
    "test_suite_name": "topmax",
    "tag":"smoke",

    "test_suite_config":{
        "tests_2_run": {"ids_2_run": ["all"], "tags_2_run":[], "tags_2_skip":{"default":["todo", "to_support", "change", "bug", "sample"],"cluster": ["cluster_table_bug"]}}
        
    },
    "comments":
        "Tests covering the steam query smoke cases.",
    "tests": [

        {
            "id": 0,
            "tags": ["topmax"],
            "name": "top_k w/o count in stream global aggregation",
            "description": "create a table test_topmax, 1 column for 1 type and ingest data top_k on int",
            "steps":[
                {"statements": [
                    {"client":"python", "query_type": "table","wait":1, "query":"drop stream if exists test9_topmax"},
                    {"client":"python", "query_type": "table", "wait":2, "query":"create stream if not exists test9_topmax (uuid uuid, int int, uint uint8, string string, float float, decimal decimal32(3), date date, datetime datetime, enum enum('a'=1, 'b'=2, 'z'=26), tuple tuple(s string, i int), ipv4 ipv4, ipv6 ipv6, map map(string, int), nullable nullable(datetime64), timestamp datetime64(3) default now64(3))"},
                    {"client":"python","query_id":"901", "query_end_timer":10, "query_type": "stream", "query":"select top_k(int,3,true) from test9_topmax limit 1"},                    
                    {"client":"python", "query_type": "table","depends_on":901,"wait":2,"depends_on_stream":"test9_topmax", "query":
                        "insert into test9_topmax (uuid, int, uint, string, float, decimal, date, datetime, enum, tuple, ipv4, ipv6, map, nullable, timestamp) values
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a1', -1234561, 1234561, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'a', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:11')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a2', -1234561, 1234562, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'b', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:12','2020-01-01 11:11:12')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a3', -1234562, 1234563, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'z', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:13' ,'2020-01-01 11:11:13')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a4', -1234562, 1234564, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'a', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:14')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a5', -1234563, 1234565, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'b', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:15')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b1', -1234563, 1234566, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'z', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:16')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b2', -1234564, 1234567, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'a', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:17' ,'2020-01-01 11:11:17')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b3', -1234564, 1234568, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'b', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:18','2020-01-01 11:11:18')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b4', -1234565, 1234560, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'z', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:19')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b5', -1234565, 1234570, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'a', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:20')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c1', -1234566, 1234571, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'b', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:21')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c2', -1234566, 1234572, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'z', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:22' ,'2020-01-01 11:11:22')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c3', -1234567, 1234573, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'a', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:23' ,'2020-01-01 11:11:23')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c4', -1234567, 1234574, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'b', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:24')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c5', -1234568, 1234575, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'z', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:25')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d1', -1234568, 1234576, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'a', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:26')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d2', -1234569, 1234577, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'b', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:27' ,'2020-01-01 11:11:27')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d3', -1234569, 1234578, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'z', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:28' ,'2020-01-01 11:11:28')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d4', -1234569, 1234579, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'a', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:29')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d5', -1234569, 1234580, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'b', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:30')"}                       

                    ]}
            ],

            "expected_results": [{"query_id":"901", "expected_results":[
                ["[(-1234569, 4), (-1234561, 2), (-1234562, 2)]"]
                
                ]}
            ]
        },
        {
            "id": 1,
            "tags": ["topmax"],
            "name": "top_k on tubple of (int, map) w/ count in stream global aggregation  ",
            "description": "create a table test_topmax, 1 column for 1 type and ingest data top_k on (int, map)",
            "steps":[
                {"statements": [
                    {"client":"python", "query_type": "table", "query":"drop stream if exists test9_topmax"},
                    {"client":"python", "query_type": "table","wait":3, "query":"create stream if not exists test9_topmax (uuid uuid, int int, uint uint8, string string, float float, decimal decimal32(3), date date, datetime datetime, enum enum('a'=1, 'b'=2, 'z'=26), tuple tuple(s string, i int), ipv4 ipv4, ipv6 ipv6, map map(string, int), nullable nullable(datetime64), timestamp datetime64(3) default now64(3))"},
                    {"client":"python","query_id":"901", "query_end_timer":8, "query_type": "stream", "query":"select array_join(top_k((int, map),3,true)) from test9_topmax limit 2"},                    
                    {"client":"python", "query_type": "table","depends_on": 901, "wait":2, "depends_on_stream":"test9_topmax","query":
                        "insert into test9_topmax (uuid, int, uint, string, float, decimal, date, datetime, enum, tuple, ipv4, ipv6, map, nullable, timestamp) values
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a1', -1234561, 1234561, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'a', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:11')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a2', -1234561, 1234562, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'b', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:12','2020-01-01 11:11:12')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a3', -1234562, 1234563, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'z', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:13' ,'2020-01-01 11:11:13')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a4', -1234562, 1234564, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'a', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:14')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a5', -1234563, 1234565, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'b', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:15')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b1', -1234563, 1234566, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'z', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:16')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b2', -1234564, 1234567, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'a', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:17' ,'2020-01-01 11:11:17')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b3', -1234564, 1234568, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'b', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:18','2020-01-01 11:11:18')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b4', -1234565, 1234560, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'z', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:19')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b5', -1234565, 1234570, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'a', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:20')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c1', -1234566, 1234571, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'b', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:21')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c2', -1234566, 1234572, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'z', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:22' ,'2020-01-01 11:11:22')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c3', -1234567, 1234573, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'a', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:23' ,'2020-01-01 11:11:23')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c4', -1234567, 1234574, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'b', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:24')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c5', -1234568, 1234575, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'z', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:25')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d1', -1234568, 1234576, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'a', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:26')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d2', -1234569, 1234577, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'b', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:27' ,'2020-01-01 11:11:27')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d3', -1234569, 1234578, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'z', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:28' ,'2020-01-01 11:11:28')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d4', -1234569, 1234579, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'a', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:29')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d5', -1234569, 1234580, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'b', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:30')"}
                        ]}
            ],

            "expected_results": [{"query_id":"901", "expected_results":[
                ["any_value,any_value, 1)"],
                ["any_value,any_value, 1)"]
                ]}
            ]
        },
        {
            "id": 2,
            "tags": ["topmax"],
            "name": "top_k in tumble",
            "description": "create a table test_topmax, 1 column for 1 type and ingest data top_k on (int,map) on tumble window",
            "steps":[
                {"statements": [
                    {"client":"python", "query_type": "table","wait":1, "query":"drop stream if exists test9_topmax"},
                    {"client":"python", "query_type": "table", "wait":2, "query":"create stream if not exists test9_topmax (uuid uuid, int int, uint uint8, string string, float float, decimal decimal32(3), date date, datetime datetime, enum enum('a'=1, 'b'=2, 'z'=26), tuple tuple(s string, i int), ipv4 ipv4, ipv6 ipv6, map map(string, int), nullable nullable(datetime64), timestamp datetime64(3) default now64(3))"},                    
                    {"client":"python","query_id":"901", "query_end_timer":7, "query_type": "stream", "query":"select window_start, window_end, array_join(top_k((int, map),3,true)) from tumble(test9_topmax, timestamp, 10s) where (int=-1234561 or int=-1234566)group by window_start, window_end"},                    
                    {"client":"python", "query_type": "table","depends_on_stream":"test9_topmax","depends_on": 901, "wait":2,"query":
                        "insert into test9_topmax (uuid, int, uint, string, float, decimal, date, datetime, enum, tuple, ipv4, ipv6, map, nullable, timestamp) values
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a1', -1234561, 1234561, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'a', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:11')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a2', -1234561, 1234562, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'b', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:12','2020-01-01 11:11:12')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a3', -1234562, 1234563, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'z', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:13' ,'2020-01-01 11:11:13')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a4', -1234562, 1234564, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'a', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:14')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a5', -1234563, 1234565, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'b', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:15')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b1', -1234563, 1234566, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'z', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:16')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b2', -1234564, 1234567, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'a', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:17' ,'2020-01-01 11:11:17')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b3', -1234564, 1234568, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'b', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:18','2020-01-01 11:11:18')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b4', -1234565, 1234560, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'z', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:19')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b5', -1234565, 1234570, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'a', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:20')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c1', -1234566, 1234571, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'b', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:21')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c2', -1234566, 1234572, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'z', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:22' ,'2020-01-01 11:11:22')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c3', -1234567, 1234573, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'a', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:23' ,'2020-01-01 11:11:23')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c4', -1234567, 1234574, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'b', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:24')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c5', -1234568, 1234575, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'z', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:25')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d1', -1234568, 1234576, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'a', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:26')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d2', -1234569, 1234577, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'b', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:27' ,'2020-01-01 11:11:27')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d3', -1234569, 1234578, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'z', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:28' ,'2020-01-01 11:11:28')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d4', -1234569, 1234579, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'a', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:29')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d5', -1234569, 1234580, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'b', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:30')"}
                        ]}
            ],

            "expected_results": [{"query_id":"901", "expected_results":[
                ["2020-01-01 11:11:10","2020-01-01 11:11:20", "any_value, {'key1': 111}), 1)"],
                ["2020-01-01 11:11:10","2020-01-01 11:11:20", "any_value, {'key2': 112}), 1)"],
                ["2020-01-01 11:11:10","2020-01-01 11:11:20", "any_value, {'key1': 111}), 1)"],
                ["2020-01-01 11:11:10","2020-01-01 11:11:20", "any_value, {'key2': 112}), 1)"]
                ]}
            ]
        },

        {
            "id": 3,
            "tags": ["topmax", "change"],
            "name": "top_k in session",
            "description": "create a table test_topmax, 1 column for 1 type and ingest data top_k on (int,map) on session window",
            "steps":[
                {"statements": [
                    {"client":"python", "query_type": "table","wait":1, "query":"drop stream if exists test9_topmax"},
                    {"client":"python", "query_type": "table", "wait":2, "query":"create stream if not exists test9_topmax (uuid uuid, int int, uint uint8, string string, float float, decimal decimal32(3), date date, datetime datetime, enum enum('a'=1, 'b'=2, 'z'=26), tuple tuple(s string, i int), ipv4 ipv4, ipv6 ipv6, map map(string, int), nullable nullable(datetime64), timestamp datetime64(3) default now64(3))"},                    
                    {"client":"python","query_id":"901", "query_end_timer":7, "query_type": "stream", "query":"select top_k(ipv4, 2, true) from session(test9_topmax, timestamp, 2s) where ipv4=cast('192.168.168.161','ipv4') partition by int"},
                    {"client":"python", "query_type": "table","depends_on_stream":"test9_topmax","depends_on": 901, "wait":2,"query":
                        "insert into test9_topmax (uuid, int, uint, string, float, decimal, date, datetime, enum, tuple, ipv4, ipv6, map, nullable, timestamp) values
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a1', -1234561, 1234561, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'a', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:11')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a2', -1234561, 1234562, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'b', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:12','2020-01-01 11:11:12')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a3', -1234562, 1234563, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'z', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:13' ,'2020-01-01 11:11:13')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a4', -1234562, 1234564, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'a', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:14')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a5', -1234563, 1234565, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'b', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:15')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b1', -1234563, 1234566, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'z', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:12')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b2', -1234564, 1234567, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'a', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:12' ,'2020-01-01 11:11:17')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b3', -1234564, 1234568, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'b', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:18','2020-01-01 11:11:18')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b4', -1234565, 1234560, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'z', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:19')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b5', -1234565, 1234570, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'a', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:20')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c1', -1234566, 1234571, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'b', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:21')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c2', -1234566, 1234572, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'z', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:22' ,'2020-01-01 11:11:22')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c3', -1234567, 1234573, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'a', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:23' ,'2020-01-01 11:11:23')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c4', -1234567, 1234574, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'b', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:24')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c5', -1234568, 1234575, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'z', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:25')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d1', -1234568, 1234576, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'a', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:26')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d2', -1234569, 1234577, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'b', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:27' ,'2020-01-01 11:11:27')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d3', -1234569, 1234578, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'z', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:28' ,'2020-01-01 11:11:28')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d4', -1234569, 1234579, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'a', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:29')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d5', -1234569, 1234580, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'b', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:30')"}
                        ]}
            ],

            "expected_results": [{"query_id":"901", "expected_results":[
                ["[(IPv4Address('192.168.168.161'), 1)]"],
                ["[(IPv4Address('192.168.168.161'), 1)]"]
                ]}
            ]
        },

        {
            "id": 4,
            "tags": ["topmax", "todo"],
            "name": "top_k w/count and w/o count in table",
            "description": "create a table t_fixeds with fixed_string type and ingest, query, but of proton-python-driver",
            "steps":[
                {"statements": [
                    {"client":"python", "query_type": "table", "query":"drop stream if exists t_fixeds"},
                    {"client":"python", "query_type": "table","wait":1, "query":"create stream t_fixeds (fixeds fixed_string(32))"},
                    {"client":"python", "query_type": "table", "wait":1, "query":"insert into t_fixeds (fixeds) values ('{@fixed_string32}')"},
                    {"client":"python","query_id":"801", "query_end_timer":2, "query_type": "stream", "query":"select fixeds from t_fixeds settings seek_to = 'earliest'"}
                    ]}
            ],

            "expected_results": [{"query_id":"801", "expected_results":[
                ["{@fixed_string32}"]]}
            ]
        },
        {
            "id": 5,
            "tags": ["topmax", "todo"],
            "name": "top on datetime",
            "description": "create a table t_lowcard with low_cardinality type and ingest, query, but of proton-python-driver",
            "steps":[
                {"statements": [
                    {"client":"python", "query_type": "table", "query":"drop stream if exists t_lowcard"},
                    {"client":"python", "query_type": "table","wait":1, "query":"create stream t_lowcard (lowcard low_cardinality(string))"},
                    {"client":"python", "query_type": "table", "wait":1, "query":"insert into t_lowcard (lowcard) values ('{@lowcardinalitystring}')"},
                    {"client":"python","query_id":"801", "query_end_timer":2, "query_type": "stream", "query":"select lowcard from t_lowcard settings seek_to = 'earliest'"}
                    ]}
            ],

            "expected_results": [{"query_id":"801", "expected_results":[
                ["{@lowcardinalitystring}"]]}
            ]
        },
        {
            "id": 6,
            "tags": ["topmax", "todo"],
            "name": "top on json",
            "description": "create a table t_lowcard with low_cardinality type and ingest, query, but of proton-python-driver",
            "steps":[
                {"statements": [
                    {"client":"python", "query_type": "table", "query":"drop stream if exists t_lowcard"},
                    {"client":"python", "query_type": "table","wait":1, "query":"create stream t_lowcard (lowcard low_cardinality(string))"},
                    {"client":"python", "query_type": "table", "wait":1, "query":"insert into t_lowcard (lowcard) values ('{@lowcardinalitystring}')"},
                    {"client":"python","query_id":"801", "query_end_timer":2, "query_type": "stream", "query":"select lowcard from t_lowcard settings seek_to = 'earliest'"}
                    ]}
            ],

            "expected_results": [{"query_id":"801", "expected_results":[
                ["{@lowcardinalitystring}"]]}
            ]
        },
        {
            "id": 7,
            "tags": ["topmax", "todo"],
            "name": "top on float output in order",
            "description": "create a table t_lowcard with low_cardinality type and ingest, query, but of proton-python-driver",
            "steps":[
                {"statements": [
                    {"client":"python", "query_type": "table", "query":"drop stream if exists t_lowcard"},
                    {"client":"python", "query_type": "table", "wait":1, "query":"create stream t_lowcard (lowcard low_cardinality(string))"},
                    {"client":"python", "query_type": "table", "wait":1, "query":"insert into t_lowcard (lowcard) values ('{@lowcardinalitystring}')"},
                    {"client":"python","query_id":"801", "query_end_timer":2, "query_type": "stream", "query":"select lowcard from t_lowcard settings seek_to = 'earliest'"}
                    ]}
            ],

            "expected_results": [{"query_id":"801", "expected_results":[
                ["{@lowcardinalitystring}"]]}
            ]
        },
        {
            "id": 10,
            "tags": ["topmax", "change"],
            "name": "max on float output in order",
            "description": "create a table test_topmax, 1 column for 1 type and ingest data max_k on float on session window",
            "steps":[
                {"statements": [
                    {"client":"python", "query_type": "table","wait":1, "query":"drop stream if exists test9_topmax"},
                    {"client":"python", "query_type": "table", "wait":2, "query":"create stream if not exists test9_topmax (uuid uuid, int int, uint uint8, string string, float float, decimal decimal32(3), date date, datetime datetime, enum enum('a'=1, 'b'=2, 'z'=26), tuple tuple(s string, i int), ipv4 ipv4, ipv6 ipv6, map map(string, int), nullable nullable(datetime64), timestamp datetime64(3) default now64(3))"},                    
                    {"client":"python","query_id":"901", "query_end_timer":7, "query_type": "stream", "query":"select max_k(ipv4, 2), window_start, window_end from session(test9_topmax, timestamp, 2s) partition by uuid group by window_start, window_end"},
                    {"client":"python", "query_type": "table","depends_on_stream":"test9_topmax","depends_on": 901, "wait":2,"query":
                        "insert into test9_topmax (uuid, int, uint, string, float, decimal, date, datetime, enum, tuple, ipv4, ipv6, map, nullable, timestamp) values
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a1', -1234561, 1234561, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'a', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null, to_datetime64('2020-01-01 11:11:11', 3, 'UTC'))
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a1', -1234561, 1234562, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'b', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:12', to_datetime64('2020-01-01 11:11:12', 3, 'UTC'))
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a1', -1234562, 1234563, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'z', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:13', to_datetime64('2020-01-01 11:11:13', 3, 'UTC'))
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a1', -1234562, 1234564, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'a', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null, to_datetime64('2020-01-01 11:11:14', 3, 'UTC'))
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a1', -1234563, 1234565, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'b', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null, to_datetime64('2020-01-01 11:11:15', 3, 'UTC'))
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b1', -1234563, 1234566, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'z', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null, to_datetime64('2020-01-01 11:11:12', 3, 'UTC'))
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b1', -1234564, 1234567, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'a', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:12', to_datetime64('2020-01-01 11:11:17', 3, 'UTC'))
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b1', -1234564, 1234568, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'b', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:18', to_datetime64('2020-01-01 11:11:18', 3, 'UTC'))
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b1', -1234565, 1234560, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'z', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null, to_datetime64('2020-01-01 11:11:19', 3, 'UTC'))
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b1', -1234565, 1234570, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'a', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null, to_datetime64('2020-01-01 11:11:20', 3, 'UTC'))
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c1', -1234566, 1234571, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'b', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null, to_datetime64('2020-01-01 11:11:21', 3, 'UTC'))
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c1', -1234566, 1234572, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'z', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:22', to_datetime64('2020-01-01 11:11:22', 3, 'UTC'))
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c1', -1234567, 1234573, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'a', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:23', to_datetime64('2020-01-01 11:11:23', 3, 'UTC'))
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c1', -1234567, 1234574, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'b', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null, to_datetime64('2020-01-01 11:11:24', 3, 'UTC'))
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c1', -1234568, 1234575, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'z', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null, to_datetime64('2020-01-01 11:11:25', 3, 'UTC'))
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d1', -1234568, 1234576, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'a', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null, to_datetime64('2020-01-01 11:11:26', 3, 'UTC'))
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d1', -1234569, 1234577, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'b', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:27', to_datetime64('2020-01-01 11:11:27', 3, 'UTC'))
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d1', -1234569, 1234578, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'z', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:28', to_datetime64('2020-01-01 11:11:28', 3, 'UTC'))
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d1', -1234569, 1234579, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'a', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null, to_datetime64('2020-01-01 11:11:29', 3, 'UTC'))
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d1', -1234569, 1234580, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'b', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null, to_datetime64('2020-01-01 11:11:30', 3, 'UTC'))"}
                        ]}
            ],

            "expected_results": [{"query_id":"901", "expected_results":[
                ["[IPv4Address('192.168.168.161')]","2020-01-01 11:11:12+00:00", "2020-01-01 11:11:12.001000+00:00"],
                ["[IPv4Address('192.168.168.165'), IPv4Address('192.168.168.164')]", "2020-01-01 11:11:11+00:00", "2020-01-01 11:11:15+00:00"],
                ["[IPv4Address('192.168.168.165'), IPv4Address('192.168.168.164')]", "2020-01-01 11:11:17+00:00", "2020-01-01 11:11:20+00:00"]
                ]}
            ]
        },
        {
            "id": 11,
            "tags": ["topmax"],
            "name": "max on float output in order",
            "description": "create a table test_topmax, 1 column for 1 type and ingest data max_k on float on session window",
            "steps":[
                {"statements": [
                    {"client":"python", "query_type": "table","wait":1, "query":"drop stream if exists test9_topmax"},
                    {"client":"python", "query_type": "table", "wait":2, "query":"create stream if not exists test9_topmax (uuid uuid, int int, uint uint8, string string, float float, decimal decimal32(3), date date, datetime datetime, enum enum('a'=1, 'b'=2, 'z'=26), tuple tuple(s string, i int), ipv4 ipv4, ipv6 ipv6, map map(string, int), nullable nullable(datetime64), timestamp datetime64(3) default now64(3))"},                    
                    {"client":"python","query_id":"901", "query_end_timer":7, "query_type": "stream", "query":"select uuid, max_k(ipv4,2) from tumble(test9_topmax, timestamp, 2s) where uuid = '4c6a2a19-4f9f-456f-b076-c43ef97255d1' group by uuid, window_end"},                    
                    {"client":"python", "query_type": "table", "depends_on_stream":"test9_topmax","depends_on": 901, "wait":2,"query":
                        "insert into test9_topmax (uuid, int, uint, string, float, decimal, date, datetime, enum, tuple, ipv4, ipv6, map, nullable, timestamp) values
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a1', -1234561, 1234561, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'a', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:11')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a1', -1234561, 1234562, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'b', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:12','2020-01-01 11:11:12')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a1', -1234562, 1234563, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'z', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:13' ,'2020-01-01 11:11:13')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a1', -1234562, 1234564, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'a', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:14')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a1', -1234563, 1234565, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'b', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:15')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b1', -1234563, 1234566, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'z', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:12')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b1', -1234564, 1234567, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'a', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:12' ,'2020-01-01 11:11:17')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b1', -1234564, 1234568, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'b', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:18','2020-01-01 11:11:18')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b1', -1234565, 1234560, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'z', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:19')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b1', -1234565, 1234570, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'a', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:20')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c1', -1234566, 1234571, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'b', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:21')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c1', -1234566, 1234572, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'z', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:22' ,'2020-01-01 11:11:22')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c1', -1234567, 1234573, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'a', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:23' ,'2020-01-01 11:11:23')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c1', -1234567, 1234574, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'b', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:24')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c1', -1234568, 1234575, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'z', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:25')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d1', -1234568, 1234576, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'a', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:26')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d1', -1234569, 1234577, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'b', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:27' ,'2020-01-01 11:11:27')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d1', -1234569, 1234578, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'z', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:28' ,'2020-01-01 11:11:28')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d1', -1234569, 1234579, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'a', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:29')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d1', -1234569, 1234580, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'b', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:30')"}
                        ]}
            ],

            "expected_results": [{"query_id":"901", "expected_results":[
                ["4c6a2a19-4f9f-456f-b076-c43ef97255d1", "[IPv4Address('192.168.168.162'), IPv4Address('192.168.168.161')]"],
                ["4c6a2a19-4f9f-456f-b076-c43ef97255d1", "[IPv4Address('192.168.168.164'), IPv4Address('192.168.168.163')]"]
                ]}
            ]
        },
        {
            "id": 12,
            "tags": ["topmax"],
            "name": "top_k_exact w/o count in stream global aggregation",
            "description": "create a table test_topmax, 1 column for 1 type and ingest data top_k_exact on int",
            "steps":[
                {"statements": [
                    {"client":"python", "query_type": "table","wait":1, "query":"drop stream if exists test9_topmax"},
                    {"client":"python", "query_type": "table", "wait":2, "query":"create stream if not exists test9_topmax (uuid uuid, int int, uint uint8, string string, float float, decimal decimal32(3), date date, datetime datetime, enum enum('a'=1, 'b'=2, 'z'=26), tuple tuple(s string, i int), ipv4 ipv4, ipv6 ipv6, map map(string, int), nullable nullable(datetime64), timestamp datetime64(3) default now64(3))"},
                    {"client":"python","query_id":"901", "query_end_timer":10, "query_type": "stream", "query":"select top_k_exact(int,3,true) from test9_topmax limit 1"},                    
                    {"client":"python", "query_type": "table","depends_on":901,"depends_on_stream":"test9_topmax", "wait":3,"query":
                        "insert into test9_topmax (uuid, int, uint, string, float, decimal, date, datetime, enum, tuple, ipv4, ipv6, map, nullable, timestamp) values
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a1', -1234561, 1234561, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'a', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:11')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a2', -1234561, 1234562, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'b', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:12','2020-01-01 11:11:12')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a3', -1234562, 1234563, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'z', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:13' ,'2020-01-01 11:11:13')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a4', -1234562, 1234564, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'a', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:14')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255a5', -1234563, 1234565, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'b', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:15')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b1', -1234563, 1234566, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'z', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:16')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b2', -1234564, 1234567, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'a', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:17' ,'2020-01-01 11:11:17')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b3', -1234564, 1234568, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'b', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:18','2020-01-01 11:11:18')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b4', -1234565, 1234560, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'z', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:19')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255b5', -1234565, 1234570, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'a', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:20')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c1', -1234566, 1234571, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'b', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:21')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c2', -1234566, 1234572, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'z', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:22' ,'2020-01-01 11:11:22')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c3', -1234567, 1234573, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'a', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:23' ,'2020-01-01 11:11:23')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c4', -1234567, 1234574, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'b', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:24')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255c5', -1234568, 1234575, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'z', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:25')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d1', -1234568, 1234576, '{@string1}', 12341.123, 123451.123, to_date('2022-03-21'), to_datetime('2022-03-24 17:17:11'), 'a', ('a', 0), '192.168.168.161', '2a02:aa08:e000:3100::21', {'key1':111}, null ,'2020-01-01 11:11:26')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d2', -1234569, 1234577, '{@string2}', 12342.123, 123452.123, to_date('2022-03-22'), to_datetime('2022-03-24 17:17:12'), 'b', ('b', 1), '192.168.168.162', '2a02:aa08:e000:3100::22', {'key2':112}, '2020-01-01 11:11:27' ,'2020-01-01 11:11:27')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d3', -1234569, 1234578, '{@string3}', 12343.123, 123453.123, to_date('2022-03-23'), to_datetime('2022-03-24 17:17:13'), 'z', ('c', 2), '192.168.168.163', '2a02:aa08:e000:3100::23', {'key3':113}, '2020-01-01 11:11:28' ,'2020-01-01 11:11:28')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d4', -1234569, 1234579, '{@string4}', 12344.123, 123454.123, to_date('2022-03-24'), to_datetime('2022-03-24 17:17:14'), 'a', ('d', 3), '192.168.168.164', '2a02:aa08:e000:3100::24', {'key4':114}, null ,'2020-01-01 11:11:29')
                        ('4c6a2a19-4f9f-456f-b076-c43ef97255d5', -1234569, 1234580, '{@string5}', 12345.123, 123455.123, to_date('2022-03-25'), to_datetime('2022-03-24 17:17:15'), 'b', ('e', 4), '192.168.168.165', '2a02:aa08:e000:3100::25', {'key5':115}, null ,'2020-01-01 11:11:30')"}                       

                    ]}
            ],

            "expected_results": [{"query_id":"901", "expected_results":[
                ["[(-1234569, 4), (-1234561, 2), (-1234562, 2)]"]
                
                ]}
            ]
        },
        {
            "id": 13,
            "tags": ["topmax"],
            "name": "top_k not accurate test",
            "description": "prove top_k not accurate with load_factor less than data range",
            "steps":[
                {"statements": [
                    {"client":"python", "query_type": "table", "query":"drop stream if exists test9_top_exact"},
                    {"client":"python", "query_type": "table","wait":3, "query":"create stream test9_top_exact(id int)"},
                    {"client":"python","query_id":"901", "query_end_timer":8, "query_type": "stream", "query":"select array_join(top_k(id,2,true,2)) from test9_top_exact"},                    
                    {"client":"python", "query_type": "table","depends_on": 901,"wait":3 , "depends_on_stream":"test9_top_exact", "wait":3,"query":
                        "insert into test9_top_exact(id) select number from numbers(20)"},
                        {"client":"python", "query_type": "table","depends_on": 901, "wait":3 , "depends_on_stream":"test9_top_exact", "wait":3,"query":
                            "insert into test9_top_exact(id) select number from numbers(20) where number >10"}
                        ]}
            ],

            "expected_results": [{"query_id":"901", "expected_results":[
                ["(16, 2)"],
                ["(17, 2)"],
                ["(16, 3)"],
                ["(17, 3)"]
                ]}
            ]
        },
        {
            "id": 14,
            "tags": ["topmax"],
            "name": "test top_k_exact",
            "description": "test whether top_k_exact is accurate",
            "steps":[
                {"statements": [
                    {"client":"python", "query_type": "table", "query":"drop stream if exists test9_top_exact"},
                    {"client":"python", "query_type": "table","wait":3, "query":"create stream test9_top_exact(id int)"},
                    {"client":"python","query_id":"901", "query_end_timer":8, "query_type": "stream", "query":"select array_join(top_k_exact(id,2,true)) from test9_top_exact"},                    
                    {"client":"python", "query_type": "table","depends_on": 901,"wait":3 , "depends_on_stream":"test9_top_exact", "wait":3,"query":
                        "insert into test9_top_exact(id) select number from numbers(20)"},
                        {"client":"python", "query_type": "table","depends_on": 901, "wait":3 , "depends_on_stream":"test9_top_exact", "wait":3,"query":
                            "insert into test9_top_exact(id) select number from numbers(20) where number >10"}
                        ]}
            ],

            "expected_results": [{"query_id":"901", "expected_results":[
                ["(0, 1)"],
                ["(1, 1)"],
                ["(11, 2)"],
                ["(12, 2)"]
                ]}
            ]
        },
        {
            "id": 15,
            "tags": ["topmax"],
            "name": "test top_k_exact",
            "description": "test whether top_k_exact is accurate with default memory",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"901", "query_type": "table", "query":"select top_k_exact(number,10) from numbers(10000000000)"}
                        ]}
            ],

            "expected_results": [{"query_id":"901", "expected_results":"error_code:69"}
            ]
        },
        {
            "id": 16,
            "tags": ["topmax"],
            "name": "test top_k_exact",
            "description": "test whether top_k_exact is accurate with assigned memory",
            "steps":[
                {"statements": [
                    {"client":"python","query_id":"901", "query_type": "table", "query":"select top_k_exact(number,10,true,10*1024*1024) from numbers(10000000000)"}
                        ]}
            ],

            "expected_results": [{"query_id":"901", "expected_results":"error_code:69"}
            ]
        }            

    ]
}