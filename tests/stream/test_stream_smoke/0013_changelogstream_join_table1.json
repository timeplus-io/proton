{
    "test_suite_name": "changelogstream_join_table1",
    "tag": "smoke",
    "test_suite_config": {
        "setup": {
            "statements": [
                {
                    "client": "python",
                    "query_type": "table",
                    "wait": 1,
                    "query": "drop stream if exists changelog_stream"
                },
                {
                    "client": "python",
                    "query_type": "table",
                    "wait": 2,
                    "query": "create stream if not exists changelog_stream(i int) settings mode='changelog'"
                },
                {
                    "client": "python",
                    "query_type": "table",
                    "wait": 1,
                    "query": "drop stream if exists test14_changelog_kv_stream"
                },
                {
                    "client": "python",
                    "query_type": "table",
                    "wait": 2,
                    "query": "create stream if not exists test14_changelog_kv_stream(i int, s string) primary key s settings mode='changelog_kv'"
                }
            ]
        },
        "tests_2_run": {
            "ids_2_run": [
                "all"
            ],
            "tags_2_run": [],
            "tags_2_skip": {
                "default": [
                    "todo",
                    "to_support",
                    "change",
                    "bug",
                    "sample",
                    "native_not_support",
                    "not supported"
                ],
                "cluster": [
                    "view",
                    "cluster_table_bug"
                ]
            }
        }
    },
    "comments": "Tests covering the changelog stream join tables.",
    "tests": [
        {
            "id": 103,
            "tags": [
                "changelog_stream"
            ],
            "name": "single shard changelog stream",
            "description": "single shard changelog stream creation and query",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_id": "14103",
                            "depends_on_stream": "changelog_stream",
                            "query_end_timer": 7,
                            "query_type": "stream",
                            "query": "select i, _tp_delta from changelog_stream;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": 14103,
                            "wait": 2,
                            "query": "insert into changelog_stream(i) values (1)"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into changelog_stream(i, _tp_delta) values (1, -1)"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14103",
                    "expected_results": [
                        [
                            1,
                            1
                        ],
                        [
                            1,
                            -1
                        ]
                    ]
                }
            ]
        },
        {
            "id": 104,
            "tags": [
                "test14_changelog_kv_stream"
            ],
            "name": "single shard changelog_kv stream",
            "description": "single shard changelog_kv stream creation and query",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "depends_on_stream": "test14_changelog_kv_stream",
                            "query": "insert into test14_changelog_kv_stream(i, s) values (1, 'a')"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "depends_on_stream": "test14_changelog_kv_stream",
                            "query": "insert into test14_changelog_kv_stream(i, s) values (2, 'b')"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "depends_on_stream": "test14_changelog_kv_stream",
                            "query": "insert into test14_changelog_kv_stream(i, s, _tp_delta) values (1, 'a', -1), (2, 'b', -1), (3, 'b', 1), (4, 'c', 1)"
                        },
                        {
                            "client": "python",
                            "query_id": "14104",
                            "wait": 2,
                            "depends_on_stream": "test14_changelog_kv_stream",
                            "query_end_timer": 10,
                            "query_type": "stream",
                            "query": "select i, s, _tp_delta from test14_changelog_kv_stream;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": 14104,
                            "wait": 1,
                            "depends_on_stream": "test14_changelog_kv_stream",
                            "query": "insert into test14_changelog_kv_stream(i, s) values (5, 'd')"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 2,
                            "depends_on_stream": "test14_changelog_kv_stream",
                            "query": "insert into test14_changelog_kv_stream(i, s, _tp_delta) values (4, 'c', -1)"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14104",
                    "expected_results": [
                        [
                            3,
                            "b",
                            1
                        ],
                        [
                            4,
                            "c",
                            1
                        ],
                        [
                            5,
                            "d",
                            1
                        ],
                        [
                            4,
                            "c",
                            -1
                        ]
                    ]
                }
            ]
        },
        {
            "id": 105,
            "tags": [
                "changelog_stream"
            ],
            "name": "single shard changelog stream via rest",
            "description": "single shard changelog stream creation via rest",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "drop stream if exists changelog_stream_rest"
                        },
                        {
                            "client": "rest",
                            "query_type": "table",
                            "wait": 2,
                            "rest_type": "raw",
                            "query_url": "/proton/v1/ddl/streams",
                            "query_id": "14105",
                            "http_method": "POST",
                            "data": {
                                "name": "changelog_stream_rest",
                                "columns": [
                                    {
                                        "name": "i",
                                        "type": "int"
                                    }
                                ],
                                "mode": "changelog"
                            }
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14105",
                    "expected_results": {
                        "request_id": "14105"
                    }
                }
            ]
        },
        {
            "id": 106,
            "tags": [
                "changelog_stream"
            ],
            "name": "single shard changelog_kv stream via rest",
            "description": "single shard changelog_kv stream creation via rest",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "drop stream if exists test14_changelog_kv_stream_rest"
                        },
                        {
                            "client": "rest",
                            "query_type": "table",
                            "wait": 2,
                            "rest_type": "raw",
                            "query_url": "/proton/v1/ddl/streams",
                            "query_id": "14106",
                            "http_method": "POST",
                            "data": {
                                "name": "test14_changelog_kv_stream_rest",
                                "columns": [
                                    {
                                        "name": "i",
                                        "type": "int"
                                    },
                                    {
                                        "name": "k",
                                        "type": "string"
                                    }
                                ],
                                "mode": "changelog_kv",
                                "primary_key": "k"
                            }
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14106",
                    "expected_results": {
                        "request_id": "14106"
                    }
                }
            ]
        },
        {
            "id": 107,
            "tags": [
                "changelog_kv_aggr"
            ],
            "name": "aggr_func_count_and_sum_changelog_kv",
            "description": "aggregation function count and sum changelog_kv",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_changelog_kv_stream"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_changelog_kv_stream",
                            "exist_wait": 2,
                            "wait": 1,
                            "query": "create stream if not exists test14_changelog_kv_stream(id int, val float) primary key id settings mode='changelog_kv'"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, val) values (1, 1.1), (2, 2.2), (3, 3.3)"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14107",
                            "depends_on_stream": "test14_changelog_kv_stream",
                            "wait": 1,
                            "terminate": "manual",
                            "query": "select count(val), min(val), max(val), sum(val), avg(val) from test14_changelog_kv_stream emit periodic 1s"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14107-2",
                            "depends_on_stream": "test14_changelog_kv_stream",
                            "wait": 1,
                            "terminate": "manual",
                            "query": "select count_if(val, val > 2), min_if(val, val > 2), max_if(val, val > 2), sum_if(val, val > 2), avg_if(val, val > 2) from test14_changelog_kv_stream emit periodic 1s"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14107-2",
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, val) values (4, 4.4), (5, 5.5)"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, val, _tp_delta) values (3, 3.3, -1)"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, val, _tp_delta) values (1, 1.1, -1)"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14107,14107-2",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, val, _tp_delta) values (5, 5.5, -1)"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14107",
                    "expected_results": [
                        [
                            "3",
                            "1.1",
                            "3.3",
                            "6.6",
                            "2.2"
                        ],
                        [
                            "5",
                            "1.1",
                            "5.5",
                            "16.5",
                            "3.3"
                        ],
                        [
                            "4",
                            "1.1",
                            "5.5",
                            "13.2",
                            "3.3"
                        ],
                        [
                            "3",
                            "2.2",
                            "5.5",
                            "12.1",
                            "4.0333333"
                        ],
                        [
                            "2",
                            "2.2",
                            "4.4",
                            "6.6",
                            "3.3"
                        ]
                    ]
                },
                {
                    "query_id": "14107-2",
                    "expected_results": [
                        [
                            "2",
                            "2.2",
                            "3.3",
                            "5.5",
                            "2.75"
                        ],
                        [
                            "4",
                            "2.2",
                            "5.5",
                            "15.4",
                            "3.85"
                        ],
                        [
                            "3",
                            "2.2",
                            "5.5",
                            "12.1",
                            "4.0333333"
                        ],
                        [
                            "3",
                            "2.2",
                            "5.5",
                            "12.1",
                            "4.0333333"
                        ],
                        [
                            "2",
                            "2.2",
                            "4.4",
                            "6.6",
                            "3.3"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 108,
            "tags": [
                "changelog_kv_aggr"
            ],
            "name": "aggr_func_count_distinct_and_count_if_changelog_kv",
            "description": "aggregation function count_distinct and count_if changelog_kv",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_changelog_kv_stream"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_changelog_kv_stream",
                            "exist_wait": 2,
                            "wait": 1,
                            "query": "create stream if not exists test14_changelog_kv_stream(id int, val float) primary key id settings mode='changelog_kv'"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, val) values (1, 1.1), (2, 2.2), (3, 3.3)"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14108",
                            "depends_on_stream": "test14_changelog_kv_stream",
                            "wait": 1,
                            "terminate": "manual",
                            "query": "select count(1), count_distinct(val), count_if(val > 2) from test14_changelog_kv_stream emit periodic 1s"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14108",
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, val) values (4, 4.4), (5, 5.5)"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, val, _tp_delta) values (3, 3.3, -1)"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, val, _tp_delta) values (1, 1.1, -1)"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14108",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, val, _tp_delta) values (5, 5.5, -1)"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14108",
                    "expected_results": [
                        [
                            "3",
                            "3",
                            "2"
                        ],
                        [
                            "5",
                            "5",
                            "4"
                        ],
                        [
                            "4",
                            "4",
                            "3"
                        ],
                        [
                            "3",
                            "3",
                            "3"
                        ],
                        [
                            "2",
                            "2",
                            "2"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 109,
            "tags": [
                "changelog_kv_aggr",
                "native_not_support",
                "bug"
            ],
            "name": "aggr_func_unique_exact_and_unique_exact_changelog_kv",
            "description": "aggregation function unique_exact and unique_exact changelog_kv",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_changelog_kv_stream"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_changelog_kv_stream",
                            "exist_wait": 2,
                            "wait": 1,
                            "query": "create stream if not exists test14_changelog_kv_stream(id int, val float) primary key id settings mode='changelog_kv'"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, val) values (1, 1.1), (2, 2.2), (3, 3.3)"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14109",
                            "depends_on_stream": "test14_changelog_kv_stream",
                            "wait": 1,
                            "terminate": "manual",
                            "query": "select unique(id), unique_exact(val), unique_exact_if(val > 2) from test14_changelog_kv_stream emit periodic 1s"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14109",
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, val) values (4, 4.4), (5, 5.5)"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, _tp_delta) values (2, -1)"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14109",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, _tp_delta) values (3, -1)"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14109",
                    "expected_results": [
                        [
                            "3",
                            "2",
                            "1"
                        ],
                        [
                            "5",
                            "3",
                            "2"
                        ],
                        [
                            "4",
                            "3",
                            "2"
                        ],
                        [
                            "3",
                            "2",
                            "1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 110,
            "tags": [
                "changelog_kv_aggr",
                "native_not_support",
                "bug"
            ],
            "name": "aggr_func_median_and_quantile_changelog_kv",
            "description": "aggregation function median and quantile changelog_kv",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_changelog_kv_stream"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_changelog_kv_stream",
                            "exist_wait": 2,
                            "wait": 1,
                            "query": "create stream if not exists test14_changelog_kv_stream(id int, val float) primary key id settings mode='changelog_kv'"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, val) values (1, 1.1), (2, 2.2), (3, 3.3)"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14110",
                            "depends_on_stream": "test14_changelog_kv_stream",
                            "wait": 1,
                            "terminate": "manual",
                            "query": "select median(val), quantile(val, 0.5) from test14_changelog_kv_stream emit periodic 1s"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14110",
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, val) values (4, 4.4), (5, 5.5)"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14110",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, _tp_delta) values (2, -1) (3, -1)"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14110",
                    "expected_results": [
                        [
                            "2.2",
                            "2.2"
                        ],
                        [
                            "3.3",
                            "3.3"
                        ],
                        [
                            "4.4",
                            "4.4"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 111,
            "tags": [
                "changelog_kv_aggr",
                "native_not_support",
                "bug"
            ],
            "name": "aggr_func_top_k_changelog_kv",
            "description": "aggregation function top_k changelog_kv",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_changelog_kv_stream"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_changelog_kv_stream",
                            "exist_wait": 2,
                            "wait": 1,
                            "query": "create stream if not exists test14_changelog_kv_stream(id int, val float) primary key id settings mode='changelog_kv'"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, val) values (1, 1.1), (1, 2.2), (3, 3.3)"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14111",
                            "depends_on_stream": "test14_changelog_kv_stream",
                            "wait": 1,
                            "terminate": "manual",
                            "query": "select top_k(id, 2) from test14_changelog_kv_stream emit periodic 1s"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14111",
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, val) values (4, 4.4), (4, 5.5)"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14111",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, _tp_delta) values (1, -1)"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14111",
                    "expected_results": [
                        [
                            "(1, 2),(3, 1)"
                        ],
                        [
                            "(1, 2),(4, 2)"
                        ],
                        [
                            "(4, 2),(3, 1)"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 112,
            "tags": [
                "changelog_kv_aggr",
                "native_not_support",
                "bug"
            ],
            "name": "aggr_func_min_k_and_max_k_changelog_kv",
            "description": "aggregation function min_k and max_k changelog_kv",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_changelog_kv_stream"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_changelog_kv_stream",
                            "exist_wait": 2,
                            "wait": 1,
                            "query": "create stream if not exists test14_changelog_kv_stream(id int, val float) primary key id settings mode='changelog_kv'"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, val) values (1, 1.1), (1, 2.2), (3, 3.3)"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14112",
                            "depends_on_stream": "test14_changelog_kv_stream",
                            "wait": 1,
                            "terminate": "manual",
                            "query": "select min_k(val, 2, id), max_k(val, 2, id) from test14_changelog_kv_stream emit periodic 1s"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14112",
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, val) values (4, 4.4), (4, 5.5)"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14112",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_changelog_kv_stream(id, _tp_delta) values (1, -1) (5, -1)"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14112",
                    "expected_results": [
                        [
                            [
                                "(1.1, 1), (2.2, 2)"
                            ],
                            [
                                "(3.3, 3), (2.2, 2)"
                            ]
                        ],
                        [
                            [
                                "(1.1, 1), (2.2, 2)"
                            ],
                            [
                                "(5.5, 5), (4.4, 4)"
                            ]
                        ],
                        [
                            [
                                "(2.2, 2), (3.3, 3)"
                            ],
                            [
                                "(4.4, 4), (3.3, 3)"
                            ]
                        ]
                    ]
                }
            ]
        },
        {
            "id": 113,
            "tags": [
                "changelog_kv",
                "bidirectional-join",
                "not supported"
            ],
            "name": "changelog-kv_inner_join_changelog-kv",
            "description": "changelog-kv inner all join changelog-kv",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists changelog_kv_stream1"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists changelog_kv_stream2"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "changelog_kv_stream1",
                            "exist_wait": 2,
                            "wait": 1,
                            "query": "create stream if not exists changelog_kv_stream1(i int, s string) primary key s settings mode='changelog_kv'"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "changelog_kv_stream2",
                            "exist_wait": 2,
                            "wait": 1,
                            "query": "create stream if not exists changelog_kv_stream2(ii int, ss string) primary key ss settings mode='changelog_kv'"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14113",
                            "wait": 1,
                            "terminate": "manual",
                            "query": "select i, s, ii, ss, _tp_delta from changelog_kv_stream1 inner join changelog_kv_stream2 on i == ii"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14113",
                            "wait": 1,
                            "query": "insert into changelog_kv_stream1 (i, s) values (1, 's1')"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into changelog_kv_stream2 (ii, ss) values (1, 'ss1')"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into changelog_kv_stream1 (i, s) values (1, 's2')"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into changelog_kv_stream1 (i, s, _tp_delta) values (1, 's1', -1)"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14113",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into changelog_kv_stream2 (ii, ss) values (1, 'ss2')"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14113",
                    "expected_results": [
                        [
                            1,
                            "s1",
                            1,
                            "ss1",
                            1
                        ],
                        [
                            1,
                            "s2",
                            1,
                            "ss1",
                            1
                        ],
                        [
                            1,
                            "s1",
                            1,
                            "ss1",
                            1
                        ],
                        [
                            1,
                            "s2",
                            1,
                            "ss2",
                            1
                        ]
                    ]
                }
            ]
        },
        {
            "id": 114,
            "tags": [
                "appendonly",
                "table(versioned_kv)",
                "inner join"
            ],
            "name": "appendonly inner join table(versioned_kv)",
            "description": "appendonly inner join table(versioned_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_1;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_1;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_1",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_1(i int, j int, k string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_1",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_1(ii int, jj int, kk string) primary key jj settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(3, 2, 'f');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14114",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk from test14_stream_1 as a join table(test14_table_1) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14114",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14114",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 7, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14114",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "3",
                            "2",
                            "f"
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "1",
                            "3",
                            "b"
                        ],
                        [
                            "5",
                            "2",
                            "a",
                            "3",
                            "2",
                            "f"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 115,
            "tags": [
                "appendonly",
                "table(versioned_kv)",
                "left join",
                "bug"
            ],
            "name": "appendonly left join table(versioned_kv)",
            "description": "appendonly left join table(versioned_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_1;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_1;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_1",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_1(i int, j int, k string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_1",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_1(ii int, jj int, kk string) primary key jj settings mode='versioned_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(3, 2, 'f');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14115",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk from test14_stream_1 as a left join table(test14_table_1) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14115",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14115",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 7, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14115",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "3",
                            "2",
                            "f"
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "1",
                            "3",
                            "b"
                        ],
                        [
                            "5",
                            "2",
                            "a",
                            "3",
                            "2",
                            "f"
                        ],
                        [
                            "1",
                            "7",
                            "a",
                            "0",
                            "0",
                            ""
                        ]
                    ]
                }
            ]
        },
        {
            "id": 116,
            "tags": [
                "appendonly",
                "table(changelog)",
                "inner join",
                "not supported"
            ],
            "name": "appendonly inner join table(changelog)",
            "description": "appendonly inner join table(changelog)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_1;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_1;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_1",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_1(i int, j int, k string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_1",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_1(ii int, jj int, kk string) primary key jj settings mode='changelog';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk, _tp_delta) values(3, 2, 'f', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14116",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, b._tp_delta from test14_stream_1 as a inner join table(test14_table_1) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14116",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14116",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 7, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": []
        },
        {
            "id": 117,
            "tags": [
                "appendonly",
                "table(changelog)",
                "left join",
                "not supported"
            ],
            "name": "appendonly left join table(changelog)",
            "description": "appendonly left join table(changelog)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream(i int, j int, k string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table(ii int, jj int, kk string) primary key jj settings mode='changelog';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table(ii, jj, kk) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table(ii, jj, kk, _tp_delta) values(3, 2, 'f', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14117",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, b._tp_delta from test14_stream as a left join table(test14_table) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14117",
                            "wait": 1,
                            "query": "insert into test14_stream(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14117",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream(i, j, k) values(1, 7, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": []
        },
        {
            "id": 118,
            "tags": [
                "appendonly",
                "table(appendonly)",
                "left join"
            ],
            "name": "appendonly left join table(appendonly)",
            "description": "appendonly left join table(appendonly)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test15_stream_1;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test15_table_1;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test15_stream_1",
                            "exist_wait": 1,
                            "query": "create stream if not exists test15_stream_1(i int, j int, k string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test15_table_1",
                            "exist_wait": 1,
                            "query": "create stream if not exists test15_table_1(ii int, jj int, kk string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test15_table_1(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test15_table_1(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test15_table_1(ii, jj, kk) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test15_table_1(ii, jj, kk) values(3, 2, 'f');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14118",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk from test15_stream_1 as a inner join table(test15_table_1) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14118",
                            "wait": 1,
                            "query": "insert into test15_stream_1(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test15_stream_1(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test15_stream_1(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14118",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test15_stream_1(i, j, k) values(1, 7, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14118",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "3",
                            "2",
                            "f"
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "1",
                            "3",
                            "b"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "3",
                            "2",
                            "f"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 119,
            "tags": [
                "appendonly",
                "table(appendonly)",
                "left join"
            ],
            "name": "appendonly left join table(appendonly)",
            "description": "appendonly left join table(appendonly)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_1;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_1;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_1",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_1(i int, j int, k string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_1",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_1(ii int, jj int, kk string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(3, 2, 'f');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14119",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk from test14_stream_1 as a left join table(test14_table_1) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14119",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14119",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 7, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14119",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a"
                        ],
                        [
                            "1",
                            "2",
                            "a",
                            "3",
                            "2",
                            "f"
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "1",
                            "3",
                            "b"
                        ],
                        [
                            "5",
                            "2",
                            "a",
                            "1",
                            "2",
                            "a"
                        ],
                        [
                            "5",
                            "2",
                            "a",
                            "3",
                            "2",
                            "f"
                        ],
                        [
                            "1",
                            "7",
                            "a",
                            "0",
                            "0",
                            ""
                        ]
                    ]
                }
            ]
        },
        {
            "id": 120,
            "tags": [
                "appendonly",
                "table(changelog_kv)",
                "inner join"
            ],
            "name": "appendonly inner join table(changelog_kv)",
            "description": "appendonly inner join table(changelog_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_1;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_1;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_1",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_1(i int, j int, k string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_1",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_1(ii int, jj int, kk string) primary key jj settings mode='changelog_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk, _tp_delta) values(1, 2, 'a', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14120",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, b._tp_delta from test14_stream_1 as a inner join table(test14_table_1) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14120",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14120",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 7, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14120",
                    "expected_results": [
                        [
                            "1",
                            "3",
                            "a",
                            "1",
                            "3",
                            "b",
                            "1"
                        ],
                        [
                            "1",
                            "7",
                            "a",
                            "2",
                            "7",
                            "h",
                            "1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 121,
            "tags": [
                "appendonly",
                "table(changelog_kv)",
                "left join"
            ],
            "name": "appendonly left join table(changelog_kv)",
            "description": "appendonly left join table(changelog_kv)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_1;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_1;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_1",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_1(i int, j int, k string);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_1",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_1(ii int, jj int, kk string) primary key jj settings mode='changelog_kv';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk, _tp_delta) values(1, 2, 'a', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14121",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select i, j, k, ii, jj, kk, b._tp_delta from test14_stream_1 as a left join table(test14_table_1) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14121",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill": "14121",
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 7, 'a');"
                        }
                    ]
                }
            ],
            "expected_results": [
                {
                    "query_id": "14121",
                    "expected_results": [
                        [
                            "1",
                            "2",
                            "a",
                            "0",
                            "0",
                            "",
                            "0"
                        ],
                        [
                            "1",
                            "3",
                            "a",
                            "1",
                            "3",
                            "b",
                            "1"
                        ],
                        [
                            "5",
                            "2",
                            "a",
                            "0",
                            "0",
                            "",
                            "0"
                        ],
                        [
                            "1",
                            "7",
                            "a",
                            "2",
                            "7",
                            "h",
                            "1"
                        ]
                    ]
                }
            ]
        },
        {
            "id": 122,
            "tags": [
                "changelog",
                "table(changelog)",
                "inner join",
                "not supported"
            ],
            "name": "changelog inner join table(changelog)",
            "description": "changelog inner join table(changelog)",
            "steps": [
                {
                    "statements": [
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_stream_1;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "query": "drop stream if exists test14_table_1;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_stream_1",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_stream_1(i int, j int, k string) settings mode='changelog';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "exist": "test14_table_1",
                            "exist_wait": 1,
                            "query": "create stream if not exists test14_table_1(ii int, jj int, kk string) primary key jj settings mode='changelog';"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 3, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(1, 5, 'b');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk, _tp_delta) values(1, 2, 'a', -1);"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_table_1(ii, jj, kk) values(2, 7, 'h');"
                        },
                        {
                            "client": "python",
                            "query_type": "stream",
                            "query_id": "14122",
                            "wait": 3,
                            "terminate": "manual",
                            "query": "select * from test14_stream_1 as a inner join table(test14_table_1) as b on a.j = b.jj;"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "depends_on": "14122",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 3, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(5, 2, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, k) values(1, 7, 'a');"
                        },
                        {
                            "client": "python",
                            "query_type": "table",
                            "kill":14122,
                            "kill_wait": 3,
                            "wait": 1,
                            "query": "insert into test14_stream_1(i, j, _tp_delta) values(1, 2, 'a', -1);"
                        }
                    ]
                }
            ],
            "expected_results": []
        }
    ]
}